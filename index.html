<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstuPorra</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com">
// --- Efecto visual al seleccionar dos personas (zoom sutil y resto gris) ---

// A√±adimos los estilos necesarios para el efecto
const styleFocus = document.createElement("style");
styleFocus.innerHTML = `
@keyframes focusPop {
  0% { box-shadow: none; background-color: rgba(99,102,241,0.2); }
  100% { box-shadow: 0 0 25px rgba(99,102,241,0.6); background-color: rgba(99,102,241,0.3); }
}
  0% { transform: scale(1); box-shadow: none; }
  100% {  box-shadow: 0 0 20px rgba(99,102,241,0.5); }
}
.focused {
  box-shadow: 0 0 25px rgba(99,102,241,0.6);
  background-color: rgba(99,102,241,0.3);
  position: relative;
  z-index: 10;

  animation: focusPop 0.3s ease-out forwards;
  z-index: 10;
  position: relative;
}
.dimmed {
  opacity: 0.4;
  filter: grayscale(100%);
  transition: opacity 0.3s ease, filter 0.3s ease;
}
`;
document.head.appendChild(styleFocus);

// Sobrescribimos updateComparison para a√±adir el nuevo efecto visual
const oldUpdateComparison = updateComparison;
updateComparison = function() {
    oldUpdateComparison();

    // Limpiar cualquier estado anterior
    document.querySelectorAll('#clasificacion tbody tr').forEach(r => {
        r.classList.remove('focused', 'dimmed');
    });

    if (selectedRows.length === 2) {
        const [row1, row2] = selectedRows;
        const allRows = Array.from(row1.closest('tbody').querySelectorAll('tr'));

        // Aplicar efecto visual
        allRows.forEach(r => {
            if (r !== row1 && r !== row2) {
                r.classList.add('dimmed');
            }
        });
        row1.classList.add('focused');
        row2.classList.add('focused');
    }
};


// --- Funciones Deluxe ---

// Bot√≥n "Volver arriba"
const backToTop = document.createElement('button');
backToTop.id = 'back-to-top';
backToTop.innerHTML = '‚Üë';
document.body.appendChild(backToTop);

window.addEventListener('scroll', () => {
  backToTop.style.display = window.scrollY > 200 ? 'flex' : 'none';
});

backToTop.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Transici√≥n de pesta√±as con fade
tabButtons.forEach(button => {
  button.addEventListener('click', () => {
    tabContents.forEach(content => content.classList.remove('active'));
    const target = document.getElementById(button.dataset.tab);
    setTimeout(() => target.classList.add('active'), 50);
  });
});

// Versus card animado
const versusCard = document.createElement('div');
versusCard.id = 'versus-card';
document.body.appendChild(versusCard);

const oldUpdateComparisonDeluxe = updateComparison;
updateComparison = function() {
  oldUpdateComparisonDeluxe();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;

    versusCard.innerHTML = `
      <img src="${img1}" alt="${name1}">
      <span>${name1}</span>
      <span class="text-red-400 text-2xl mx-2">VS</span>
      <span>${name2}</span>
      <img src="${img2}" alt="${name2}">
    `;
    versusCard.style.display = 'flex';
  }
};




// Forzar pesta√±a "Reglas y Comodines" activa al cargar
document.addEventListener('DOMContentLoaded', () => {
  const defaultTab = document.querySelector('[data-tab="reglas"]');
  const defaultContent = document.getElementById('reglas');
  if (defaultTab && defaultContent) {
    defaultContent.classList.add('active');
    // defaultTab.classList.add('bg-indigo-700');
  }
});


// --- Versus card mejorado con puntuaciones y animaci√≥n de golpe ---
const oldUpdateComparisonPower = updateComparison;
updateComparison = function() {
  oldUpdateComparisonPower();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner, loser;
    if (score1 > score2) { winner = 1; } 
    else if (score2 > score1) { winner = 2; }
    else { winner = 0; }

    versusCard.innerHTML = `
      <div class="player ${winner === 1 ? 'text-green-400' : (winner === 2 ? 'text-red-400' : '')}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span>${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <span class="text-yellow-400 text-2xl mx-4">‚ö° VS ‚ö°</span>
      <div class="player ${winner === 2 ? 'text-green-400' : (winner === 1 ? 'text-red-400' : '')}" id="p2">
        <span class="score">${score2}</span>
        <span>${name2}</span>
        <img src="${img2}" alt="${name2}">
      </div>
    `;
    versusCard.style.display = 'flex';

    const diffMsg = document.createElement('div');
    diffMsg.id = 'versus-diff';
    diffMsg.textContent = `üí• Diferencia de puntos: ${diff}`;
    versusCard.insertAdjacentElement('afterend', diffMsg);

    // Animaciones de "golpe"
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    if (winner === 1) {
      p1.style.animation = 'pushForward 0.5s ease forwards';
      p2.style.animation = 'pushBack 0.5s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForward 0.5s ease forwards';
      p1.style.animation = 'pushBack 0.5s ease forwards';
    }
  }
};


// --- Versus card versi√≥n definitiva con animaciones y estructura visual ---
const oldUpdateComparisonFinal = updateComparison;
updateComparison = function() {
  oldUpdateComparisonFinal();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner = 0;
    if (score1 > score2) winner = 1;
    else if (score2 > score1) winner = 2;

    const p1Color = winner === 1 ? 'text-green-400' : winner === 2 ? 'text-red-400' : 'text-gray-300';
    const p2Color = winner === 2 ? 'text-green-400' : winner === 1 ? 'text-red-400' : 'text-gray-300';

    versusCard.innerHTML = `
      <div class="player ${p1Color}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span class="name">${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <span class="vs-symbol">‚ö° VS ‚ö°</span>
      <div class="player ${p2Color}" id="p2">
        <img src="${img2}" alt="${name2}">
        <span class="name">${name2}</span>
        <span class="score">${score2}</span>
      </div>
    `;
    versusCard.style.display = 'flex';

    const diffMsg = document.createElement('div');
    diffMsg.id = 'versus-diff';
    diffMsg.textContent = `üí• Diferencia de puntos: ${diff}`;
    versusCard.insertAdjacentElement('afterend', diffMsg);

    // Animaciones de impacto
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    const vsSymbol = versusCard.querySelector('.vs-symbol');

    if (winner === 1) {
      p1.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p2.style.animation = 'pushBackShake 0.6s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p1.style.animation = 'pushBackShake 0.6s ease forwards';
    }

    vsSymbol.style.animation = 'vsImpact 0.6s ease';
  }
};


// --- Ajuste: diferencia centrada debajo del VS ---
const oldUpdateComparisonCentered = updateComparison;
updateComparison = function() {
  oldUpdateComparisonCentered();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner = 0;
    if (score1 > score2) winner = 1;
    else if (score2 > score1) winner = 2;

    const p1Color = winner === 1 ? 'text-green-400' : winner === 2 ? 'text-red-400' : 'text-gray-300';
    const p2Color = winner === 2 ? 'text-green-400' : winner === 1 ? 'text-red-400' : 'text-gray-300';

    versusCard.innerHTML = `
      <div class="player ${p1Color}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span class="name">${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <div class="vs-container text-center">
        <span class="vs-symbol">‚ö° VS ‚ö°</span>
        <div class="diff-center">üí• Diferencia: ${diff}</div>
      </div>
      <div class="player ${p2Color}" id="p2">
        <img src="${img2}" alt="${name2}">
        <span class="name">${name2}</span>
        <span class="score">${score2}</span>
      </div>
    `;
    versusCard.style.display = 'flex';

    // Animaciones de impacto
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    const vsSymbol = versusCard.querySelector('.vs-symbol');

    if (winner === 1) {
      p1.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p2.style.animation = 'pushBackShake 0.6s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p1.style.animation = 'pushBackShake 0.6s ease forwards';
    }

    vsSymbol.style.animation = 'vsImpact 0.6s ease';
  }
};


// --- OVERRIDE: Clean Versus Card Rendering (final) ---
(function() {
  // Add/override styles to ensure consistent appearance
  const styleEl = document.createElement('style');
  styleEl.innerHTML = `
  /* Final versus styles - override previous conflicting rules */
  #versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;
 position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; display: none; flex-direction: row; align-items: center; justify-content: center; gap: 2rem; padding: 1rem 2rem; border-radius: 1rem; background: rgba(17,24,39,0.95); border: 2px solid rgba(99,102,241,0.12); z-index: 9999; }
  #versus-card .player { display:flex; flex-direction:column; align-items:center; min-width:130px; }
  #versus-card .player img {
  width: 85px;
  height: 85px;
 width:70px; height:70px; border-radius:50%; object-fit:cover; margin-bottom:6px; border:2px solid #818cf8; }
  #versus-card .name { font-size:1rem; margin-bottom:4px; }
  #versus-card .score { font-size:1.25rem; color:#facc15; font-weight:700; margin-top:6px; }
  #versus-card .vs-container { position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center; }
  #versus-card .vs-symbol { font-size:1.8rem; color:#facc15; display:block; }
  #versus-card .diff-center {
  background: transparent !important;
  text-shadow: none !important;
 position:absolute; top:100%; left:50%; transform:translate(-50%,6px); color:#facc15; font-weight:700; padding:6px 10px; background: rgba(0,0,0,0.2); border-radius:8px; backdrop-filter: blur(6px); box-shadow:0 6px 18px rgba(0,0,0,0.5); opacity:0; animation: popUpDiff 0.45s ease forwards; }
  @keyframes popUpDiff { 0% { transform: translate(-50%,12px) scale(0.9); opacity:0 } 60% { transform: translate(-50%, -6px) scale(1.05); opacity:1 } 100% { transform: translate(-50%,6px) scale(1); opacity:1 } }
  @keyframes pushForwardSmooth { 0% { transform: translateX(0) scale(1); } 40% { transform: translateX(18px) scale(1.08); } 100% { transform: translateX(12px) scale(1.03); } }
  @keyframes pushBackSmooth { 0% { transform: translateX(0) scale(1); opacity:1; } 100% { transform: translateX(-8px) scale(0.96); opacity:0.85; } }
  .winner-anim { animation: pushForwardSmooth 0.55s cubic-bezier(.2,.9,.3,1) forwards; }
  .loser-anim { animation: pushBackSmooth 0.55s cubic-bezier(.2,.9,.3,1) forwards; }
  `;
  document.head.appendChild(styleEl);

  // Ensure versusCard exists
  let versusCard = document.getElementById('versus-card');
  if (!versusCard) {
    versusCard = document.createElement('div');
    versusCard.id = 'versus-card';
    document.body.appendChild(versusCard);
  }

  // Replace global updateComparison with a clean version
  window.updateComparison = function() {
    // first, clear any old elements created by previous versions
    const oldDiffs = document.querySelectorAll('#versus-diff, .diff-center, .diff-center-old');
    oldDiffs.forEach(e => e.remove());

    // reset versus card
    versusCard.style.display = 'none';
    versusCard.innerHTML = '';

    // clear previous animations on players
    document.querySelectorAll('#versus-card .player').forEach(p => { p.classList.remove('winner-anim','loser-anim'); });

    if (Array.isArray(selectedRows) && selectedRows.length === 2) {
      const [row1,row2] = selectedRows;
      const name1 = row1.querySelector('td:nth-child(2) span') ? row1.querySelector('td:nth-child(2) span').textContent : (row1.querySelector('span')?row1.querySelector('span').textContent : row1.textContent.trim());
      const name2 = row2.querySelector('td:nth-child(2) span') ? row2.querySelector('td:nth-child(2) span').textContent : (row2.querySelector('span')?row2.querySelector('span').textContent : row2.textContent.trim());
      const img1 = row1.querySelector('img') ? row1.querySelector('img').src : 'https://placehold.co/64x64/374151/ffffff?text=U';
      const img2 = row2.querySelector('img') ? row2.querySelector('img').src : 'https://placehold.co/64x64/374151/ffffff?text=U';
      const score1 = parseInt(row1.dataset.score) || 0;
      const score2 = parseInt(row2.dataset.score) || 0;
      const diff = Math.abs(score1-score2);

      let winner = 0;
      if (score1 > score2) winner = 1;
      else if (score2 > score1) winner = 2;

      // Build HTML
      versusCard.innerHTML = `
        <div class="player" id="p1">
          <img src="${img1}" alt="${name1}"/>
          <span class="name" id="name1">${name1}</span>
          <span class="score" id="score1">${score1}</span>
        </div>
        <div class="vs-container">
          <span class="vs-symbol">‚ö° VS ‚ö°</span>
          <div class="diff-center" id="diff-center">üí• Diferencia: ${diff}</div>
        </div>
        <div class="player" id="p2">
          <img src="${img2}" alt="${name2}"/>
          <span class="name" id="name2">${name2}</span>
          <span class="score" id="score2">${score2}</span>
        </div>
      `;

      // color winners/losers
      const p1 = document.getElementById('p1');
      const p2 = document.getElementById('p2');
      const nameEl1 = document.getElementById('name1');
      const nameEl2 = document.getElementById('name2');
      const scoreEl1 = document.getElementById('score1');
      const scoreEl2 = document.getElementById('score2');

      if (winner === 1) {
        nameEl1.classList.add('text-green-400'); scoreEl1.classList.add('text-green-400'); p1.classList.add('winner-anim');
        nameEl2.classList.add('text-red-400'); scoreEl2.classList.add('text-red-400'); p2.classList.add('loser-anim');
      } else if (winner === 2) {
        nameEl2.classList.add('text-green-400'); scoreEl2.classList.add('text-green-400'); p2.classList.add('winner-anim');
        nameEl1.classList.add('text-red-400'); scoreEl1.classList.add('text-red-400'); p1.classList.add('loser-anim');
      } else {
        // tie: neutral colors
        nameEl1.classList.add('text-gray-200'); nameEl2.classList.add('text-gray-200');
      }

      versusCard.style.display = 'flex';

      // remove animations after they finish so subsequent opens run again
      setTimeout(()=>{
        p1.classList.remove('winner-anim','loser-anim');
        p2.classList.remove('winner-anim','loser-anim');
      }, 900);
    } else {
      // no two selected -> hide versus card
      versusCard.style.display = 'none';
    }
  };
})(); 


// --- Ocultar versus-card al hacer scroll instant√°neamente ---
window.addEventListener('scroll', () => {
  if (typeof versusCard !== 'undefined' && versusCard && versusCard.style.display === 'flex') {
    versusCard.style.display = 'none';
    const diffEl = document.querySelector('.diff-center');
    if (diffEl) diffEl.remove();
  }
});

</script>
    <!-- Fuentes personalizadas -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos generales */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #111827; /* Gris muy oscuro */
            color: #e5e7eb; /* Gris claro */
        }
        h1, h2, h3 {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
        }

        /* Estilos de las tarjetas de comod√≠n */
        .card {
            background-color: #1f2937; /* Gris oscuro */
            border-radius: 0.75rem;
            border: 1px solid #374151; /* Borde sutil */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            border-color: #4b5563; /* Borde un poco m√°s claro al pasar el rat√≥n */
        }

        /* Estilos para el estado seleccionado */
        .card.selected-favor {
            border: 3px solid #10b981; /* Verde esmeralda */
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.6);
            background-color: #064e3b; /* Fondo verde oscuro */
        }

        .card.selected-contra {
            border: 3px solid #ef4444; /* Rojo */
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.6);
            background-color: #7f1d1d; /* Fondo rojo oscuro */
        }

        /* Estilos de los botones de filtro */
        .filter-btn {
            background-color: #374151;
            color: #f3f4f6;
            transition: background-color 0.2s;
        }
        .filter-btn:hover {
            background-color: #4b5563;
        }

        /* Colores espec√≠ficos de los botones de filtro de tipo */
        .filter-btn-favor {
            background-color: #059669 !important; /* Verde */
        }
        .filter-btn-favor:hover {
            background-color: #047857 !important;
        }
        .filter-btn-contra {
            background-color: #dc2626 !important; /* Rojo */
        }
        .filter-btn-contra:hover {
            background-color: #b91c1c !important;
        }

        .filter-btn.active:not(.filter-btn-favor):not(.filter-btn-contra):not(.filter-btn-view) {
            background-color: #4f46e5; /* √çndigo para "Todos" */
        }
        
        /* Estilo del bot√≥n de "Ver Selecciones" */
        .filter-btn-view.active {
             background-color: #f59e0b !important; /* √Åmbar */
             color: #1f2937 !important;
        }
        .filter-btn-view:hover {
             background-color: #d97706 !important;
        }


        /* Estilo del texto del comod√≠n */
        .favor-text {
            color: #10b981; /* Verde esmeralda */
        }

        .contra-text {
            color: #ef4444; /* Rojo */
        }

        /* Estilos de las tablas */
        .table-header {
            background-color: #374151;
            color: #f3f4f6;
            text-transform: uppercase;
        }

        .table-row-odd {
            background-color: #1f2937;
        }

        .table-row-even {
            background-color: #111827;
        }
        
        /* Estilo para el avatar */
        .avatar {
            width: 32px;
            height: 32px;
            object-fit: cover;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid #6366f1; /* Borde √≠ndigo */
        }
    
/* Aumenta ligeramente el espacio vertical de las tablas de clasificaci√≥n */
#clasificacion table {
  min-height: 400px;
}
#clasificacion section {
  padding-bottom: 1.5rem;
}


/* Evita que el zoom de las filas afecte al tama√±o real de la tabla */
#clasificacion section {
  overflow: hidden;
}
.focused {
  box-shadow: 0 0 25px rgba(99,102,241,0.6);
  background-color: rgba(99,102,241,0.3);
  position: relative;
  z-index: 10;

  transform-origin: center center;
  will-change: transform;
}


/* --- Animaci√≥n de flotaci√≥n sutil para comodines seleccionados --- */
@keyframes float {
  0% { transform: translateY(0px); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); }
  50% { transform: translateY(-5px); box-shadow: 0 10px 15px rgba(0, 0, 0, 0.4); }
  100% { transform: translateY(0px); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); }
}

.card.selected-favor,
.card.selected-contra {
  animation: float 3s ease-in-out infinite;
}


/* --- ASTUPORRA DELUXE --- */

/* 1. Animaci√≥n de entrada y hover para comodines */
@keyframes fadeUp {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}

.card {
  animation: fadeUp 0.5s ease both;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
}



/* 3. Medallas en el top 3 */
#clasificacion-div1 tr:nth-child(1) td:first-child::after,
#clasificacion-div2 tr:nth-child(1) td:first-child::after {
  content: "ü•á";
  margin-left: 8px;
}
#clasificacion-div1 tr:nth-child(2) td:first-child::after,
#clasificacion-div2 tr:nth-child(2) td:first-child::after {
  content: "ü•à";
  margin-left: 8px;
}
#clasificacion-div1 tr:nth-child(3) td:first-child::after,
#clasificacion-div2 tr:nth-child(3) td:first-child::after {
  content: "ü•â";
  margin-left: 8px;
}

/* 4. Fade en cambio de pesta√±as */
.tab-content {
  opacity: 0;
  transition: opacity 0.4s ease;
}
.tab-content.active {
  opacity: 1;
}

/* 5. Bot√≥n ‚ÄúVolver arriba‚Äù */
#back-to-top {
  position: fixed;
  bottom: 30px;
  right: 30px;
  background-color: #4f46e5;
  color: white;
  border: none;
  border-radius: 50%;
  width: 45px;
  height: 45px;
  font-size: 1.5rem;
  display: none;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  cursor: pointer;
  transition: transform 0.3s ease, opacity 0.3s ease;
  z-index: 100;
}
#back-to-top:hover {
  transform: translateY(-4px);
}

/* 6. Versus card animado */
#versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;

  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: rgba(31,41,55,0.95);
  border: 2px solid #6366f1;
  border-radius: 1rem;
  padding: 1rem 2rem;
  display: none;
  align-items: center;
  gap: 1rem;
  color: white;
  font-weight: bold;
  box-shadow: 0 0 20px rgba(99,102,241,0.6);
  animation: fadeUp 0.5s ease forwards;
  z-index: 100;
}
#versus-card img {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid #818cf8;
}


/* --- Scroll estilo ne√≥n elegante --- */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: rgba(31, 31, 31, 0.8);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #6366f1 0%, #4f46e5 100%);
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
  transition: background 0.3s ease, box-shadow 0.3s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #818cf8 0%, #6366f1 100%);
  box-shadow: 0 0 15px rgba(129, 140, 248, 0.7);
}


/* --- Versus mejorado con puntuaciones y animaciones --- */
@keyframes popUpDiff {
  0% { transform: scale(0.7); opacity: 0; }
  60% { transform: scale(1.05); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}
@keyframes pushForward {
  0% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.1) translateY(-3px); }
  100% { transform: scale(1.05) translateY(-2px); }
}
@keyframes pushBack {
  0% { transform: scale(1); opacity: 1; }
  100% { transform: scale(0.95); opacity: 0.8; }
}
#versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;

  flex-direction: row;
  justify-content: center;
  text-align: center;
}
#versus-card .player {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: bold;
}
#versus-card .player img {
  width: 85px;
  height: 85px;

  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid #818cf8;
  object-fit: cover;
}
#versus-card .score {
  font-size: 1.25rem;
}

#versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;

  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  padding: 1rem 2rem 2rem 2rem;
  border-radius: 1rem;
}

#versus-card .diff-center {
  background: transparent !important;
  text-shadow: none !important;

  position: absolute;
  bottom: 0.4rem;
  left: 50%;
  transform: translateX(-50%);
  font-weight: bold;
  color: #facc15;
  animation: popUpDiff 0.5s ease forwards;
  font-size: 1rem;
}

#versus-diff {
  text-align: center;
  margin-top: 0.5rem;
  font-weight: bold;
  color: #facc15;
  animation: popUpDiff 0.5s ease forwards;
}


/* --- Versus card con estructura de columnas y animaci√≥n de impacto --- */
@keyframes pushForwardSmooth {
  0% { transform: translateX(0) scale(1); }
  40% { transform: translateX(15px) scale(1.1); }
  100% { transform: translateX(10px) scale(1.05); }
}
@keyframes pushBackShake {
  0% { transform: translateX(0) scale(1); }
  25% { transform: translateX(-10px) rotate(-2deg); }
  50% { transform: translateX(5px) rotate(2deg); }
  75% { transform: translateX(-3px) rotate(-1deg); }
  100% { transform: translateX(-5px) scale(0.95); opacity: 0.9; }
}
@keyframes vsImpact {
  0% { transform: scale(1); color: #facc15; }
  50% { transform: scale(1.3); color: #fbbf24; }
  100% { transform: scale(1); color: #facc15; }
}

#versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;

  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  padding: 1rem 2rem;
  border-radius: 1rem;
}

#versus-card .player {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  font-weight: bold;
  min-width: 120px;
}

#versus-card .player img {
  width: 85px;
  height: 85px;

  width: 70px;
  height: 70px;
  border-radius: 50%;
  border: 2px solid #818cf8;
  object-fit: cover;
  margin-bottom: 0.5rem;
}

#versus-card .name {
  font-size: 1rem;
  margin-bottom: 0.3rem;
}

#versus-card .score {
  font-size: 1.25rem;
  color: #facc15;
}

#versus-card .vs-symbol {
  font-size: 2rem;
  color: #facc15;
  animation: vsImpact 0.6s ease;
}


#versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;

  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  padding: 1rem 2rem 2rem 2rem;
  border-radius: 1rem;
}

#versus-card .diff-center {
  background: transparent !important;
  text-shadow: none !important;

  position: absolute;
  bottom: 0.4rem;
  left: 50%;
  transform: translateX(-50%);
  font-weight: bold;
  color: #facc15;
  animation: popUpDiff 0.5s ease forwards;
  font-size: 1rem;
}

#versus-diff {
  text-align: center;
  margin-top: 0.5rem;
  font-weight: bold;
  color: #facc15;
  animation: popUpDiff 0.5s ease forwards;
}

</style>
</head>
<body class="min-h-screen">
    <!-- Contenedor principal centrado -->
    <div class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Encabezado y T√≠tulo -->
        <header class="text-center mb-10 border-b-2 border-indigo-500 pb-4">
            <h1 class="text-5xl font-bold text-indigo-400 tracking-wider">AstuPorra</h1>
            <p class="text-lg text-gray-400 mt-2">La Quiniela Definitiva de Wrestling</p>
        </header>

        <!-- Navegaci√≥n de pesta√±as -->
        <div class="mb-8 flex space-x-4 border-b border-gray-700">
            <button class="tab-button p-3 font-semibold text-lg border-b-4 border-indigo-500 text-indigo-400 transition duration-300" data-tab="reglas">
                Reglas y Comodines
            </button>
            <button class="tab-button p-3 font-semibold text-lg text-gray-400 hover:text-indigo-400 transition duration-300" data-tab="clasificacion">
                Clasificaci√≥n
            </button>
        </div>

        <!-- Contenido de las Pesta√±as -->
        
        <!-- Pesta√±a 1: Reglas y Comodines -->
        <div id="reglas" class="tab-content">
            
            <!-- Reglas Fundamentales -->
            <section class="mb-10 p-6 bg-gray-800 rounded-xl shadow-2xl border border-gray-700">
                <h2 class="text-3xl font-bold mb-4 text-yellow-400">Reglas Fundamentales</h2>
                <ul class="list-disc list-inside space-y-2 text-gray-300 ml-4">
                    <li><span class="font-bold text-yellow-300">Uso entre participantes de la misma divisi√≥n:</span> Los comodines solo se pueden usar contra otros participantes de tu misma divisi√≥n (1¬™ Divisi√≥n contra 1¬™ Divisi√≥n, 2¬™ Divisi√≥n contra 2¬™ Divisi√≥n).</li>
                    <li><span class="font-bold text-yellow-300">Un comod√≠n por PPV/PLE:</span> Solo puedes elegir y usar un √∫nico comod√≠n por evento (PPV/PLE).</li>
                    <li><span class="font-bold text-yellow-300">Dos ataques por evento:</span> Un oponente solo puede ser atacado un m√°ximo de dos veces por evento.</li>
                </ul>
            </section>

            <!-- Proceso de Selecci√≥n de Comod√≠n -->
            <section class="mb-10 p-6 bg-gray-800 rounded-xl shadow-2xl border border-gray-700">
                <h2 class="text-3xl font-bold mb-4 text-pink-400">Proceso de Selecci√≥n de Comod√≠n</h2>
                <div class="space-y-4">
                    <div class="flex items-start">
                        <span class="text-2xl font-bold mr-4 text-pink-400">1.</span>
                        <p class="text-gray-300">El orden de los turnos para la elecci√≥n de comod√≠n se determinar√° por la <span class="font-bold text-pink-300">clasificaci√≥n del evento anterior</span> (el √∫ltimo PPV/PLE). El √∫ltimo clasificado elige primero, y el primero, el √∫ltimo.</p>
                    </div>
                    <div class="flex items-start">
                        <span class="text-2xl font-bold mr-4 text-pink-400">2.</span>
                        <p class="text-gray-300">Cada participante tendr√° <span class="font-bold text-pink-300">12 horas</span> para elegir su comod√≠n una vez le toque el turno. De no hacerlo, perder√° su oportunidad de usar comod√≠n en dicho evento.</p>
                    </div>
                </div>
            </section>

            <!-- Explorador de Comodines -->
            <section class="p-6 bg-gray-900 rounded-xl shadow-2xl border border-indigo-700">
                <h2 class="text-4xl font-bold mb-6 text-indigo-400">Explorador de Comodines</h2>
                
                <!-- Resumen de selecci√≥n y Formulario de Env√≠o (V√°lido solo para UN comod√≠n) -->
                <div id="summary-box" class="mb-6 p-4 rounded-lg bg-gray-700 border border-gray-600 hidden">
                    <h3 class="text-xl font-bold mb-2 text-indigo-300">Comodines Seleccionados: <span id="selection-count" class="font-extrabold text-white">0</span></h3>
                    
                    <div id="selected-wildcard-list" class="mb-4 space-y-2">
                        <!-- Aqu√≠ se lista el comod√≠n seleccionado -->
                    </div>
                    
                    <form id="selection-form" class="space-y-3">
                        <input type="text" id="discord-user-selector" placeholder="@Tu Usuario de Discord (Ej: @SrKaiser)" 
                            class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:ring-green-500 focus:border-green-500 text-gray-200" required>
                        
                        <button type="submit" id="send-button" disabled
                            class="w-full bg-gray-500 text-white font-bold py-3 px-4 rounded-lg transition duration-300 shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                            Selecciona 1 comod√≠n para Enviar a Discord
                        </button>
                    </form>

                    <!-- Mensaje de estado (√©xito/error) -->
                    <div id="status-message" class="mt-4 p-3 rounded-lg text-sm font-medium hidden"></div>

                </div>

                <!-- Filtros -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <!-- B√∫squeda -->
                    <input type="text" id="search-input" placeholder="Buscar por nombre o efecto..." 
                        class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500 text-gray-200 col-span-full md:col-span-2">

                    <!-- Uso (Timing) -->
                    <select id="uso-filter" class="p-3 rounded-lg bg-gray-700 border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500 text-gray-200">
                        <option value="all">Uso (Timing)</option>
                        <option value="Antes">Antes</option>
                        <option value="Durante">Durante</option>
                        <option value="Despu√©s">Despu√©s</option>
                        <option value="Antes / Durante">Antes / Durante</option>
                        <option value="Durante / Despu√©s">Durante / Despu√©s</option>
                    </select>

                    <!-- Orientaci√≥n (Alcance) -->
                    <select id="orientacion-filter" class="p-3 rounded-lg bg-gray-700 border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500 text-gray-200">
                        <option value="all">Orientaci√≥n (Alcance)</option>
                        <option value="Media / Baja">Media / Baja</option>
                        <option value="Divisional">Divisional</option>
                        <option value="General">General</option>
                        <option value="2¬™ Divisi√≥n">2¬™ Divisi√≥n</option>
                    </select>
                </div>

                <!-- Filtros de Tipo y Visibilidad -->
                <div class="flex flex-wrap gap-3 mb-8">
                    <button class="filter-btn p-2 rounded-lg font-semibold" data-filter-type="all">Todos</button>
                    <button class="filter-btn p-2 rounded-lg font-semibold" data-filter-type="favor">A Favor</button>
                    <button class="filter-btn p-2 rounded-lg font-semibold" data-filter-type="contra">En Contra</button>
                    <!-- Este bot√≥n ahora mostrar√° la lista de selecciones m√∫ltiples -->
                    <button id="view-selection-btn" class="filter-btn filter-btn-view p-2 rounded-lg font-semibold" data-filter-type="selection">
                        Ver mi Selecci√≥n (0)
                    </button>
                </div>

                <!-- Contenedor de Comodines -->
                <div id="wildcard-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Las tarjetas de comodines se insertar√°n aqu√≠ con JavaScript -->
                </div>
            </section>
        </div>

        <!-- Pesta√±a 2: Clasificaci√≥n (Contenido generado por JS) -->
        <div id="clasificacion" class="tab-content hidden">
            
            <h2 class="text-4xl font-bold mb-6 text-indigo-400 text-center">Clasificaci√≥n General</h2>

            <!-- Contenedor de la 1¬™ Divisi√≥n -->
            <section class="mb-10">
                <h3 class="text-3xl font-bold mb-4 text-green-400 text-center border-b border-green-700 pb-2">1¬™ Divisi√≥n</h3>
                <div class="overflow-x-auto rounded-lg shadow-xl">
                    <table class="min-w-full divide-y divide-gray-700">
                        <thead>
                            <tr>
                                <th class="table-header px-6 py-3 text-left text-xs font-medium tracking-wider w-1/6">Pos.</th>
                                <th class="table-header px-6 py-3 text-left text-xs font-medium tracking-wider w-4/6">Usuario</th>
                                <th class="table-header px-6 py-3 text-right text-xs font-medium tracking-wider w-1/6">Total</th>
                            </tr>
                        </thead>
                        <tbody id="clasificacion-div1" class="divide-y divide-gray-700">
                            <!-- Datos de la 1¬™ Divisi√≥n generados por JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Contenedor de la 2¬™ Divisi√≥n -->
            <section>
                <h3 class="text-3xl font-bold mb-4 text-blue-400 text-center border-b border-blue-700 pb-2">2¬™ Divisi√≥n</h3>
                <div class="overflow-x-auto rounded-lg shadow-xl">
                    <table class="min-w-full divide-y divide-gray-700">
                        <thead>
                            <tr>
                                <th class="table-header px-6 py-3 text-left text-xs font-medium tracking-wider w-1/6">Pos.</th>
                                <th class="table-header px-6 py-3 text-left text-xs font-medium tracking-wider w-4/6">Usuario</th>
                                <th class="table-header px-6 py-3 text-right text-xs font-medium tracking-wider w-1/6">Total</th>
                            </tr>
                        </thead>
                        <tbody id="clasificacion-div2" class="divide-y divide-gray-700">
                            <!-- Datos de la 2¬™ Divisi√≥n generados por JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

    </div>

    <script>
        // URL del Webhook de Discord proporcionada por el usuario.
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1422665966982270997/0InFBupzK6zYLFE2gq4y6LaLvcqcLjJ-HdJ4KcLotJsvaiJvJ_XIgKWwR6MDhhK81X1O';

        // --- DATOS DE CLASIFICACI√ìN Y AVATARES ---
        const standings = {
            division1: [
                { position: '1¬∫', user: 'Fabio', score: 562 },
                { position: '2¬∫', user: 'MrKev719', score: 562 }, 
                { position: '3¬∫', user: 'Gonsa', score: 561 },
                { position: '4¬∫', user: 'Geroo', score: 560 },
                { position: '5¬∫', user: 'BlissedAstu', score: 545 },
                { position: '6¬∫', user: 'AEKCarlos', score: 541 },
                { position: '7¬∫', user: 'bautiiiii', score: 476 }
            ],
            division2: [
                { position: '1¬∫', user: 'DannyLopez_90', score: 536 },
                { position: '2¬∫', user: 'Nelsonageitos', score: 533 },
                { position: '3¬∫', user: 'jairlopezojeda', score: 528 },
                { position: '4¬∫', user: 'Ruiz24_', score: 469 },
                { position: '5¬∫', user: 'Slyever', score: 360 },
                { position: '6¬∫', user: 'patodiego', score: 306 },
                { position: '7¬∫', user: 'AceSoul', score: 132 },
                { position: '8¬∫', user: 'dany_1208', score: 98 }
            ]
        };

        const userAvatars = {
            'Fabio': 'img/Fabio.png',
            'MrKev719': 'img/MrKev719_2.png',
            'BlissedAstu': 'img/BlissedAstu.png',
            'Geroo': 'img/Geroo.png',
            'Gonsa': 'img/Gonsa.png',
            'AEKCarlos': 'img/AEKCarlos.png',
            'bautiiiii': 'img/bautiiiii.png',
            'Nelsonageitos': 'img/Nelsonageitos.png',
            'DannyLopez_90': 'img/DannyLopez_90.png',
            'jairlopezojeda': 'img/jairlopezojeda.png',
            'Ruiz24_': 'img/Ruiz24.png',
            'Slyever': 'img/Slyever.png',
            'patodiego': 'img/patodiego.png',
            'dany_1208': 'img/dany_1208.png',
            'AceSoul': 'img/AceSoul.png'
        };

        // --- DATOS DE COMODINES (SIN CAMBIOS) ---
        const wildcards = [
            // A FAVOR (25)
            { id: 1, name: "Phoenix Splash", type: "favor", explanation: "Si aciertas el ganador del combate inicial del PPV, obtienes un bono de +4 puntos en ese combate.", use: "Despu√©s", orientation: "Media / Baja" },
            { id: 2, name: "GTS (Go to Sleep)", type: "favor", explanation: "Puedes \"dormir\" un comod√≠n En Contra que otro usuario de tu misma divisi√≥n haya usado contra ti en este PPV, dej√°ndolo inactivo.", use: "Antes / Durante", orientation: "Divisional" },
            { id: 3, name: "Guerrilla Tactics", type: "favor", explanation: "Si fallas una predicci√≥n, puedes usar este comod√≠n para cambiar el resultado.", use: "Despu√©s", orientation: "General" },
            { id: 4, name: "Five Knuckle Shuffle", type: "favor", explanation: "Te permite duplicar los puntos obtenidos en una predicci√≥n si es un combate sin t√≠tulo en juego.", use: "Antes", orientation: "General" },
            { id: 5, name: "Sweet Chin Music", type: "favor", explanation: "Si predices que el combate terminar√° por super-kick o finisher de impacto visual, y aciertas, obtienes +3 puntos extra.", use: "Antes", orientation: "General" },
            { id: 6, name: "Foreign Exchange", type: "favor", explanation: "Puedes intercambiar tu predicci√≥n menos popular por la m√°s popular de un rival en tu misma divisi√≥n.", use: "Antes", orientation: "Divisional" },
            { id: 7, name: "Macho Madness", type: "favor", explanation: "Si aciertas el resultado de todos los combates con vestimenta extravagante o gimmick particular, obtienes +7 puntos.", use: "Despu√©s", orientation: "General" },
            { id: 8, name: "Diamond Cutter", type: "favor", explanation: "Si tu predicci√≥n de un combate termina en menos de 3 minutos, y la aciertas, obtienes x3 los puntos.", use: "Despu√©s", orientation: "General" },
            { id: 9, name: "Head of the Table", type: "favor", explanation: "Si aciertas la predicci√≥n de todos los campeonatos masculinos principales, obtienes un bono de +6 puntos.", use: "Despu√©s", orientation: "General" },
            { id: 10, name: "EST of WWE", type: "favor", explanation: "Si aciertas la predicci√≥n de todos los campeonatos femeninos principales, obtienes un bono de +6 puntos.", use: "Despu√©s", orientation: "General" },
            { id: 11, name: "Countdown Clock", type: "favor", explanation: "Te permite enviar una predicci√≥n para un combate espec√≠fico hasta 1 minuto antes de que comience ese combate.", use: "Durante", orientation: "General" },
            { id: 12, name: "Legend Killer", type: "favor", explanation: "Si predices y aciertas la victoria de una estrella joven sobre un veterano, obtienes +5 puntos extra.", use: "Antes", orientation: "General" },
            { id: 13, name: "Punt Kick", type: "favor", explanation: "Elige a un luchador \"favorito\" (el que m√°s gente predijo); si pierde, obtienes +8 puntos.", use: "Antes", orientation: "General" },
            { id: 14, name: "Rated R Superstar", type: "favor", explanation: "Si aciertas la predicci√≥n de un combate que termine por sumisi√≥n o rendici√≥n, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { id: 15, name: "The List of Jericho", type: "favor", explanation: "Elige a un rival de tu misma divisi√≥n; si aciertas el mismo n√∫mero de predicciones que √©l, obtienes +3 puntos adicionales sobre su total.", use: "Despu√©s", orientation: "Divisional" },
            { id: 16, name: "People Power", type: "favor", explanation: "Si aciertas la victoria del luchador que es √∫ltima opci√≥n en la predicci√≥n de la mayor√≠a, obtienes +5 puntos extra.", use: "Antes", orientation: "Media / Baja" },
            { id: 17, name: "The Viper's RKO", type: "favor", explanation: "Puedes cambiar la predicci√≥n de un combate ya cerrado por la que menos gente ha elegido como ganadora.", use: "Antes", orientation: "General" },
            { id: 18, name: "Cesaro Swing", type: "favor", explanation: "Si aciertas una predicci√≥n triple o fatal de cuatro esquinas, los puntos se multiplican por x2.", use: "Antes", orientation: "General" },
            { id: 19, name: "Coup de Gr√¢ce", type: "favor", explanation: "Si aciertas la predicci√≥n del Main Event con una explicaci√≥n detallada sobre el booking, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { id: 20, name: "Sister Abigail", type: "favor", explanation: "Te permite hacer una doble predicci√≥n en un combate: si aciertas ambas (ganador y m√©todo), triplicas los puntos.", use: "Antes", orientation: "General" },
            { id: 21, name: "Cross Rhodes", type: "favor", explanation: "Anula una penalizaci√≥n de puntos que te haya impuesto un comod√≠n En Contra de tu misma divisi√≥n.", use: "Durante / Despu√©s", orientation: "Divisional" },
            { id: 22, name: "Coast to Coast", type: "favor", explanation: "Si aciertas una predicci√≥n de combate de escaleras, mesas o sillas, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { id: 23, name: "Hulk Up", type: "favor", explanation: "Si fallas tu predicci√≥n del Main Event, pero tu luchador \"favorito\" gana, se te suma +5 puntos para mitigar la p√©rdida.", use: "Antes", orientation: "General" },
            { id: 24, name: "Division Ace", type: "favor", explanation: "Elige a un luchador; si t√∫ eres el √∫nico de tu divisi√≥n que predice su victoria, y aciertas, obtienes +4 puntos extra.", use: "Antes", orientation: "Divisional" },
            { id: 25, name: "Promotion Play", type: "favor", explanation: "Si eres de la 2¬™ Divisi√≥n y aciertas todos tus combates, obtienes un bono de +10 puntos para el total de la porra.", use: "Despu√©s", orientation: "2¬™ Divisi√≥n" },
            
            // EN CONTRA (25)
            { id: 26, name: "Relegation Threat", type: "contra", explanation: "Obligas a que la predicci√≥n del Main Event de un rival de tu misma divisi√≥n valga solo 1 punto si acierta.", use: "Antes", orientation: "Divisional" },
            { id: 27, name: "Bottom Feeder Lock", type: "contra", explanation: "La predicci√≥n con m√°s puntos de un rival de tu misma divisi√≥n vale 0 si la acierta.", use: "Antes", orientation: "Divisional" },
            { id: 28, name: "Mid-Card Blockade", type: "contra", explanation: "Elige a un rival de la mitad superior de tu misma divisi√≥n; su predicci√≥n m√°s popular se le resta -4 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { id: 29, name: "The Manager's Cut", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta, y ese combate tuvo interferencia de un Manager, pierde -3 puntos.", use: "Antes", orientation: "Divisional" },
            { id: 30, name: "Draw Out", type: "contra", explanation: "Si hay un empate en el n√∫mero de aciertos entre t√∫ y un rival de tu misma divisi√≥n, puedes restarle -5 puntos del total de la porra.", use: "Despu√©s", orientation: "Divisional" },
            { id: 31, name: "Contender‚Äôs Trap", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta la predicci√≥n de un combate por t√≠tulo secundario, no suma ning√∫n punto.", use: "Antes", orientation: "Divisional" },
            { id: 32, name: "Suspension", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; no puede usar ning√∫n comod√≠n en el pr√≥ximo PPV.", use: "Antes", orientation: "Divisional" },
            { id: 33, name: "Backstage Politics", type: "contra", explanation: "Obliga al rival de tu misma divisi√≥n a que su predicci√≥n del combate m√°s largo del PPV valga 0 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { id: 34, name: "The Curse of the Zone", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n que vaya en la zona baja; su predicci√≥n del Main Event se anula si la acierta.", use: "Antes", orientation: "Divisional" },
            { id: 35, name: "Division Jump", type: "contra", explanation: "Puedes cambiar la predicci√≥n del Main Event de un rival de tu misma divisi√≥n a un resultado de Descalificaci√≥n.", use: "Antes", orientation: "Divisional" },
            { id: 36, name: "Disqualification Push", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; su predicci√≥n de combate debe ser Descalificaci√≥n; si acierta, solo suma 1 punto.", use: "Antes", orientation: "Divisional" },
            { id: 37, name: "Rating Drop", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta un combate que la mayor√≠a predijo que ganar√≠a el Face, solo suma la mitad de los puntos.", use: "Antes", orientation: "Divisional" },
            { id: 38, name: "The Gold Diggers", type: "contra", explanation: "Si un rival de tu misma divisi√≥n usa un comod√≠n \"A Favor\" para obtener puntos extra, puedes robar 50% de esos puntos extra.", use: "Despu√©s", orientation: "Divisional" },
            { id: 39, name: "Injury Angle", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta menos de la mitad de sus predicciones, le restas -6 puntos del total de la porra.", use: "Despu√©s", orientation: "Divisional" },
            { id: 40, name: "Losers Bracket", type: "contra", explanation: "Si el rival va en la mitad inferior de su divisi√≥n, su predicci√≥n m√°s popular resta -2 puntos si acierta.", use: "Antes", orientation: "Media / Baja" },
            { id: 41, name: "False Finish", type: "contra", explanation: "Elige la predicci√≥n de un rival de tu misma divisi√≥n; si su luchador gana, pero el combate tiene un final r√°pido/pol√©mico, pierde -3 puntos.", use: "Antes", orientation: "Divisional" },
            { id: 42, name: "Booking Block", type: "contra", explanation: "Anula cualquier comod√≠n A Favor de un rival de tu misma divisi√≥n cuyo prop√≥sito sea a√±adir puntos extra.", use: "Antes", orientation: "Divisional" },
            { id: 43, name: "The Veteran's Gate", type: "contra", explanation: "Obliga a un rival de tu misma divisi√≥n a que su predicci√≥n m√°s importante sea sobre un luchador veterano que t√∫ elijas.", use: "Antes", orientation: "Divisional" },
            { id: 44, name: "Heel Turn", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si su predicci√≥n m√°s importante es de un luchador Face, y gana, solo suma 2 puntos.", use: "Antes", orientation: "Divisional" },
            { id: 45, name: "Bad Booking", type: "contra", explanation: "Puedes cambiar el resultado de la predicci√≥n de un rival de tu misma divisi√≥n al menos popular entre todos los usuarios.", use: "Antes", orientation: "Divisional" },
            { id: 46, name: "Career Threat Match", type: "contra", explanation: "Si el rival de tu misma divisi√≥n acierta su predicci√≥n, y es un combate por un contrato/carrera, no suma ning√∫n punto.", use: "Antes", orientation: "Divisional" },
            { id: 47, name: "The Forbidden Door", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; su pr√≥ximo comod√≠n A Favor usado solo puede anular un comod√≠n En Contra de la misma divisi√≥n.", use: "Antes / Durante", orientation: "Divisional" },
            { id: 48, name: "Championship Curse", type: "contra", explanation: "Elige la predicci√≥n de un rival de tu misma divisi√≥n; si es por un t√≠tulo mundial y el campe√≥n retiene, la predicci√≥n resta -5 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { id: 49, name: "Unstoppable Dominator", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n que tenga un 80% o m√°s de aciertos; su siguiente predicci√≥n solo le dar√° 1 punto si acierta.", use: "Durante", orientation: "Divisional" },
            { id: 50, name: "The Corporate Mandate", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si tiene dos predicciones con el mismo resultado, ambas restan -3 puntos si acierta una.", use: "Antes", orientation: "Divisional" }
        ];

        // Estado de la aplicaci√≥n
        // AHORA PERMITE SELECCI√ìN M√öLTIPLE para previsualizar.
        let temporarySelections = new Set(); 
        let isViewingSelections = false; 
        
        // Estado de los filtros
        const filters = {
            search: '',
            type: 'all',
            use: 'all', 
            orientation: 'all'
        };

        // Referencias a elementos del DOM
        const wildcardContainer = document.getElementById('wildcard-container');
        const searchInput = document.getElementById('search-input');
        const typeButtons = document.querySelectorAll('[data-filter-type]');
        const usoFilter = document.getElementById('uso-filter');
        const orientacionFilter = document.getElementById('orientacion-filter');
        const summaryBox = document.getElementById('summary-box');
        const selectedWildcardList = document.getElementById('selected-wildcard-list');
        const selectionCount = document.getElementById('selection-count');
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const selectionForm = document.getElementById('selection-form');
        const discordUserSelectorInput = document.getElementById('discord-user-selector');
        const sendButton = document.getElementById('send-button');
        const statusMessage = document.getElementById('status-message');
        const viewSelectionBtn = document.getElementById('view-selection-btn');
        const div1Body = document.getElementById('clasificacion-div1');
        const div2Body = document.getElementById('clasificacion-div2');
        
        // --- L√≥gica de Pesta√±as ---

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.dataset.tab;

                // Ocultar todos los contenidos y desactivar todos los botones
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });
                tabButtons.forEach(btn => {
                    btn.classList.remove('border-b-4', 'border-indigo-500', 'text-indigo-400');
                    btn.classList.add('text-gray-400', 'hover:text-indigo-400');
                });

                // Mostrar el contenido objetivo y activar el bot√≥n
                document.getElementById(targetTab).classList.remove('hidden');
                button.classList.add('border-b-4', 'border-indigo-500', 'text-indigo-400');
                button.classList.remove('text-gray-400', 'hover:text-indigo-400');
            });
        });

        // --- L√≥gica de Clasificaci√≥n ---

        /**
         * Genera una fila de la tabla de clasificaci√≥n.
         * @param {Object} entry - Objeto de clasificaci√≥n ({ position, user, score }).
         * @param {number} index - √çndice de la fila (para alternar colores).
         * @returns {string} HTML de la fila.
         */
        function createStandingsRow(entry, index) {
            const rowClass = index % 2 === 0 ? 'table-row-odd' : 'table-row-even';
            const positionColor = index < 3 ? 'text-yellow-400' : 'text-gray-400';
            const avatarUrl = userAvatars[entry.user] || 'https://placehold.co/32x32/374151/ffffff?text=U'; // Avatar por defecto
            
            return `
                <tr class="${rowClass}">
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium ${positionColor}">${entry.position}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex items-center">
                            <img src="${avatarUrl}" alt="Avatar de ${entry.user}" class="avatar" onerror="this.onerror=null;this.src='https://placehold.co/32x32/374151/ffffff?text=U';">
                            <span>${entry.user}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-bold text-gray-300">${entry.score}</td>
                </tr>
            `;
        }
        
        /**
         * Renderiza ambas tablas de clasificaci√≥n.
         */
        function renderStandings() {
            // Renderizar 1¬™ Divisi√≥n
            div1Body.innerHTML = standings.division1.map((entry, index) => 
                createStandingsRow(entry, index)
            ).join('');

            // Renderizar 2¬™ Divisi√≥n
            div2Body.innerHTML = standings.division2.map((entry, index) => 
                createStandingsRow(entry, index)
            ).join('');
        }


        // --- L√≥gica de Comodines y Filtrado ---

        /**
         * Muestra un mensaje de estado (√©xito o error).
         * @param {string} message - El mensaje a mostrar.
         * @param {string} type - 'success' o 'error'.
         */
        function showStatusMessage(message, type) {
            statusMessage.textContent = message;
            statusMessage.classList.remove('hidden', 'bg-red-800', 'text-red-200', 'bg-green-800', 'text-green-200');
            
            if (type === 'success') {
                statusMessage.classList.add('bg-green-800', 'text-green-200');
            } else if (type === 'error') {
                statusMessage.classList.add('bg-red-800', 'text-red-200');
            }

            // Ocultar el mensaje despu√©s de 5 segundos
            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 5000);
        }

        /**
         * Maneja la selecci√≥n/deselecci√≥n de una tarjeta de comod√≠n.
         * AHORA PERMITE SELECCI√ìN M√öLTIPLE para previsualizaci√≥n.
         * @param {number} id - El ID del comod√≠n.
         */
        function toggleWildcardSelection(id) {
            // Limpiar mensaje de estado al cambiar la selecci√≥n
            statusMessage.classList.add('hidden');
            
            // Si ya est√° seleccionado, lo quitamos
            if (temporarySelections.has(id)) {
                temporarySelections.delete(id);
            } else {
                // Si no est√° seleccionado, lo a√±adimos (se permite selecci√≥n m√∫ltiple)
                temporarySelections.add(id);
            }
            
            // Renderiza de nuevo la lista para actualizar las clases visuales y filtros
            renderWildcards();
            
            // Actualiza el resumen (que valida si hay 1 seleccionado para el env√≠o)
            updateSummaryButton();
        }

        /**
         * Crea el elemento HTML para una tarjeta de comod√≠n.
         * @param {Object} wildcard - Objeto comod√≠n.
         * @returns {HTMLElement} El elemento div de la tarjeta.
         */
        function createWildcardCard(wildcard) {
            const isSelected = temporarySelections.has(wildcard.id);
            const typeClass = wildcard.type === 'favor' ? 'selected-favor' : 'selected-contra';
            const textClass = wildcard.type === 'favor' ? 'favor-text' : 'contra-text';
            const icon = wildcard.type === 'favor' ? '‚Üë' : '‚Üì'; // Usamos un icono simple

            const card = document.createElement('div');
            card.className = `card p-4 flex flex-col justify-between h-full ${isSelected ? typeClass : ''}`;
            card.dataset.id = wildcard.id;
            
            card.innerHTML = `
                <div>
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-xl font-bold ${textClass}">${wildcard.name}</h3>
                        <span class="text-2xl font-black ${textClass}">${icon}</span>
                    </div>
                    <p class="text-sm text-gray-400 mb-3 italic">Uso: <span class="font-medium">${wildcard.use}</span> | Alcance: <span class="font-medium">${wildcard.orientation}</span></p>
                    <p class="text-gray-300 text-sm">${wildcard.explanation}</p>
                </div>
                <!-- Indicador de selecci√≥n -->
                <div class="mt-4 text-center">
                    <span class="text-xs font-semibold uppercase tracking-wider ${isSelected ? 'text-white p-1 rounded-full' : 'text-gray-500'} ${isSelected ? (wildcard.type === 'favor' ? 'bg-green-600' : 'bg-red-600') : 'hidden'}">
                        ${isSelected ? 'SELECCIONADO' : ''}
                    </span>
                </div>
            `;

            card.addEventListener('click', () => {
                toggleWildcardSelection(wildcard.id);
            });

            return card;
        }

        /**
         * Aplica los filtros actuales al array de comodines.
         * @returns {Array} Array de comodines filtrados.
         */
        function getFilteredWildcards() {
            let list = wildcards;
            
            // Filtro de "Ver mi Selecci√≥n"
            if (isViewingSelections) {
                // Solo devuelve los comodines cuyos IDs est√°n en el Set de selecciones
                list = list.filter(w => temporarySelections.has(w.id));
                return list;
            }

            // Aplicar filtros normales (B√∫squeda, Tipo, Uso, Orientaci√≥n)
            return list.filter(wildcard => {
                // Filtro de B√∫squeda
                const searchMatch = wildcard.name.toLowerCase().includes(filters.search.toLowerCase()) || 
                                    wildcard.explanation.toLowerCase().includes(filters.search.toLowerCase());
                if (!searchMatch) return false;

                // Filtro de Tipo
                const typeMatch = filters.type === 'all' || wildcard.type === filters.type;
                if (!typeMatch) return false;

                // Filtro de Uso
                const useMatch = filters.use === 'all' || wildcard.use === filters.use;
                if (!useMatch) return false;

                // Filtro de Orientaci√≥n
                const orientacionMatch = filters.orientation === 'all' || wildcard.orientation === filters.orientation;
                if (!orientacionMatch) return false;

                return true;
            });
        }

        /**
         * Renderiza las tarjetas de comodines en el contenedor y actualiza contadores.
         */
        function renderWildcards() {
            const filteredList = getFilteredWildcards();
            wildcardContainer.innerHTML = ''; // Limpiar el contenedor
            
            const allButton = document.querySelector('[data-filter-type="all"]');
            const favorButton = document.querySelector('[data-filter-type="favor"]');
            const contraButton = document.querySelector('[data-filter-type="contra"]');
            
            const totalCount = wildcards.length; 
            const favorCount = wildcards.filter(w => w.type === 'favor').length;
            const contraCount = wildcards.filter(w => w.type === 'contra').length;
            
            // Actualizar contadores en los botones
            allButton.textContent = `Todos (${totalCount})`;
            favorButton.textContent = `A Favor (${favorCount})`;
            contraButton.textContent = `En Contra (${contraCount})`;
            viewSelectionBtn.textContent = `Ver mi Selecci√≥n (${temporarySelections.size})`;


            if (filteredList.length === 0) {
                wildcardContainer.innerHTML = `<p class="text-center text-gray-400 col-span-full py-8">
                    ${isViewingSelections ? 'No has seleccionado ning√∫n comod√≠n.' : 'No se encontraron comodines con los filtros aplicados.'}
                </p>`;
                return;
            }

            filteredList.forEach(wildcard => {
                wildcardContainer.appendChild(createWildcardCard(wildcard));
            });
        }

        /**
         * Actualiza la caja de resumen con la selecci√≥n actual.
         * Muestra TODOS los comodines seleccionados en la lista, pero solo habilita el env√≠o si hay 1.
         */
        function updateSummaryButton() {
            const selectedIdsArray = Array.from(temporarySelections);
            const selectionCountValue = selectedIdsArray.length;
            selectionCount.textContent = selectionCountValue;
            selectedWildcardList.innerHTML = '';
            
            // Mostrar u ocultar la caja de resumen general
            if (selectionCountValue > 0) {
                summaryBox.classList.remove('hidden');

                // Listar TODAS las selecciones
                selectedIdsArray.forEach(id => {
                    const currentWildcard = wildcards.find(w => w.id === id);
                    if (currentWildcard) {
                        const textClass = currentWildcard.type === 'favor' ? 'text-green-400' : 'text-red-400';
                        const typeText = currentWildcard.type === 'favor' ? 'A FAVOR' : 'EN CONTRA';
                        const listItem = document.createElement('p');
                        listItem.className = 'text-base font-medium';
                        listItem.innerHTML = `‚Ä¢ <span class="font-bold ${textClass}">${currentWildcard.name}</span> (<span class="${textClass}">${typeText}</span>)`;
                        selectedWildcardList.appendChild(listItem);
                    }
                });

                // Habilitar/Deshabilitar bot√≥n de env√≠o (VALIDACI√ìN DE REGLA)
                const isOneSelected = selectionCountValue === 1;
                sendButton.disabled = !isOneSelected;
                sendButton.classList.toggle('bg-gray-500', !isOneSelected);
                sendButton.classList.toggle('bg-green-600', isOneSelected);
                sendButton.classList.toggle('hover:bg-green-700', isOneSelected);
                
                if (isOneSelected) {
                    sendButton.textContent = 'Confirmar y Enviar Comod√≠n a Discord';
                } else {
                    sendButton.textContent = `‚ö† Selecciona solo 1 comod√≠n para Enviar (Regla PPV)`;
                }


            } else {
                // Si no hay selecciones, ocultar el resumen
                summaryBox.classList.add('hidden');
                sendButton.disabled = true;
                sendButton.classList.remove('bg-green-600', 'hover:bg-green-700');
                sendButton.classList.add('bg-gray-500');
                sendButton.textContent = `Selecciona 1 comod√≠n para Enviar a Discord`;
            }
        }

        /**
         * Env√≠a el mensaje al Webhook de Discord.
         * @param {string} selectorUser - Usuario de Discord que hace la selecci√≥n.
         */
        async function sendDiscordWebhook(selectorUser) {
            // Se valida de nuevo, pero la UI ya solo permite llegar aqu√≠ si hay exactamente 1 seleccionado.
            if (temporarySelections.size !== 1) {
                showStatusMessage('‚ùå Debes seleccionar exactamente UN comod√≠n para enviar (Regla: Un comod√≠n por PPV).', 'error');
                return;
            }

            const selectedId = Array.from(temporarySelections)[0];
            const wildcard = wildcards.find(w => w.id === selectedId);
            
            if (!wildcard) return; 
            
            const color = wildcard.type === 'favor' ? 65280 : 16711680; // Verde o Rojo
            const typeText = wildcard.type === 'favor' ? "A Favor (Beneficio)" : "En Contra (Ataque)";
            
            // Mensaje de contenido para el chat
            const contentMessage = `¬°@${selectorUser} ha elegido comod√≠n! ¬°Revisen las reglas de selecci√≥n!`;

            // Construcci√≥n del footer
            let footerText = `Formato de chat: Elijo comod√≠n ${wildcard.name}`;
            
            // Si es EN CONTRA, recordamos que debe enviar el objetivo por privado
            if (wildcard.type === 'contra') {
                footerText += `. (Recordatorio: debe enviar el @rival atacado por privado al administrador)`;
            } else {
                // Si es A FAVOR, aclaramos que la elecci√≥n es p√∫blica y no necesita m√°s
                footerText += `. (Este comod√≠n A Favor es p√∫blico y su uso est√° confirmado)`;
            }

            const payload = {
                username: "AstuPorra Bot", 
                avatar_url: "https://placehold.co/128x128/indigo/white?text=A", 
                content: contentMessage,
                embeds: [
                    {
                        title: `WILD CARD: ${wildcard.name} (${typeText})`,
                        description: `**USUARIO ELEGIDO:** @${selectorUser}`,
                        color: color,
                        fields: [
                            {
                                name: "Timing (Uso)",
                                value: wildcard.use,
                                inline: true
                            },
                            {
                                name: "Alcance",
                                value: wildcard.orientation,
                                inline: true
                            },
                            {
                                name: "Efecto",
                                value: wildcard.explanation,
                                inline: false
                            }
                        ],
                        footer: {
                            text: footerText
                        },
                        timestamp: new Date().toISOString()
                    }
                ]
            };

            try {
                // Deshabilitar bot√≥n mientras se env√≠a
                sendButton.textContent = 'Enviando...';
                sendButton.disabled = true;

                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                });

                sendButton.textContent = 'Confirmar y Enviar Comod√≠n a Discord';
                sendButton.disabled = false;


                if (response.ok) {
                    showStatusMessage(`‚úÖ ¬°Comod√≠n '${wildcard.name}' enviado a Discord con √©xito!`, 'success');
                    
                    // Limpiar solo el comod√≠n enviado, no toda la selecci√≥n m√∫ltiple
                    temporarySelections.delete(selectedId); 
                    discordUserSelectorInput.value = '';
                    renderWildcards();
                    updateSummaryButton();
                } else {
                    const errorText = await response.text();
                    console.error('Error al enviar Webhook:', response.status, errorText);
                    showStatusMessage(`‚ùå Error al enviar el comod√≠n (C√≥digo: ${response.status}). Revisa la consola para m√°s detalles.`, 'error');
                }
            } catch (error) {
                console.error('Error de red al enviar el Webhook:', error);
                sendButton.textContent = 'Confirmar y Enviar Comod√≠n a Discord';
                sendButton.disabled = false;
                showStatusMessage('‚ùå Error de conexi√≥n. No se pudo contactar con Discord.', 'error');
            }
        }

        // --- Event Listeners ---

        // Listener para el env√≠o del formulario
        selectionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const selectedId = Array.from(temporarySelections)[0];
            
            // Validaci√≥n RESTAURADA a un solo comod√≠n para el ENV√çO
            if (temporarySelections.size !== 1) {
                showStatusMessage('‚ùå Debes seleccionar exactamente UN comod√≠n para enviar (Regla: Un comod√≠n por PPV).', 'error');
                return;
            }

            let selectorUser = discordUserSelectorInput.value.trim();

            if (!selectorUser || selectorUser.length < 2) {
                showStatusMessage('‚ùå Introduce @Tu Usuario de Discord (qui√©n env√≠a el comod√≠n).', 'error');
                return;
            }

            // Limpiar el '@' si el usuario lo introdujo
            const cleanSelectorUser = selectorUser.startsWith('@') ? selectorUser.substring(1) : selectorUser;

            // Enviar el webhook
            sendDiscordWebhook(cleanSelectorUser);
        });


        // Listeners de Filtro

        searchInput.addEventListener('input', () => {
            filters.search = searchInput.value;
            isViewingSelections = false; // Desactiva la vista de selecci√≥n al buscar
            renderWildcards();
        });

        typeButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Resetear estado 'active' en todos, excepto en "Ver mis Selecciones"
                typeButtons.forEach(btn => {
                    if (btn.dataset.filterType !== 'selection') {
                        btn.classList.remove('active', 'filter-btn-favor', 'filter-btn-contra');
                    }
                });
                viewSelectionBtn.classList.remove('active');
                
                const type = button.dataset.filterType; 
                filters.type = type;
                isViewingSelections = false; // Desactiva la vista de selecci√≥n

                if (type !== 'selection') {
                    button.classList.add('active');
                    if (type === 'favor') button.classList.add('filter-btn-favor');
                    if (type === 'contra') button.classList.add('filter-btn-contra');
                }

                renderWildcards();
            });
        });

        // Listener para "Ver mi Selecci√≥n"
        viewSelectionBtn.addEventListener('click', () => {
             // Resetear filtros visuales normales (excepto los de b√∫squeda)
             typeButtons.forEach(btn => {
                if (btn.dataset.filterType !== 'selection') {
                    btn.classList.remove('active', 'filter-btn-favor', 'filter-btn-contra');
                }
            });

            isViewingSelections = !isViewingSelections; // Cambiar el estado de visualizaci√≥n

            if (isViewingSelections) {
                viewSelectionBtn.classList.add('active', 'filter-btn-view');
                filters.type = 'all'; // Ignorar filtro de tipo normal
            } else {
                viewSelectionBtn.classList.remove('active', 'filter-btn-view');
                filters.type = 'all'; // Volver a mostrar todos
                document.querySelector('[data-filter-type="all"]').classList.add('active'); // Activar el bot√≥n "Todos"
            }
            renderWildcards();
        });

        usoFilter.addEventListener('change', (e) => {
            filters.use = e.target.value;
            isViewingSelections = false; // Desactiva la vista de selecci√≥n al filtrar
            renderWildcards();
        });

        orientacionFilter.addEventListener('change', (e) => {
            filters.orientation = e.target.value;
            isViewingSelections = false; // Desactiva la vista de selecci√≥n al filtrar
            renderWildcards();
        });
        
        // Inicializaci√≥n al cargar el documento
        document.addEventListener('DOMContentLoaded', () => {
            // Renderizar los comodines iniciales
            renderWildcards();
            // Asegurar que el resumen est√© oculto o muestre el estado inicial
            updateSummaryButton();
            // Renderizar la clasificaci√≥n
            renderStandings();

            // L√≥gica para establecer el estado inicial de los botones de tipo
            document.querySelector('[data-filter-type="all"]').classList.add('active');
            
            addRowClickListeners();
});

// --- L√≥gica de comparaci√≥n con efecto POP-UP ---
let selectedRows = [];

// Creamos un estilo personalizado para la animaci√≥n pop-up
const style = document.createElement("style");
style.innerHTML = `
@keyframes popUp {
  0% { transform: scale(0.7); opacity: 0; }
  60% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}
.pop-up {
  animation: popUp 0.4s ease-out forwards;
}
`;
document.head.appendChild(style);

// Funci√≥n que muestra la diferencia con el efecto pop-up
function updateComparison() {
    // Eliminar mensaje previo
    const existingDiff = document.getElementById('score-diff');
    if (existingDiff) existingDiff.remove();

    if (selectedRows.length === 2) {
        const [row1, row2] = selectedRows;
        const score1 = parseInt(row1.dataset.score);
        const score2 = parseInt(row2.dataset.score);
        const diff = Math.abs(score1 - score2);
        const division = row1.closest('tbody').id;

        // Crear contenedor del mensaje
        const diffMsg = document.createElement('div');
        diffMsg.id = 'score-diff';
        diffMsg.className = `
            text-center mt-4 text-xl font-extrabold text-yellow-300 
            pop-up transform transition-all
        `;
        diffMsg.textContent = `‚ö° Diferencia de puntos: ${diff}`;

        // Insertar debajo de la tabla correspondiente
        const tableSection = document.getElementById(division).closest('section');
        tableSection.appendChild(diffMsg);
    }
}

// Funci√≥n para manejar clics en las filas
function handleRowClick(event) {
    const row = event.currentTarget;
    const division = row.closest('tbody').id;

    // Si ya est√° seleccionada ‚Üí deseleccionarla
    if (selectedRows.includes(row)) {
        row.classList.remove('bg-indigo-700', 'shadow-lg', 'ring-2', 'ring-indigo-400');
        selectedRows = selectedRows.filter(r => r !== row);
        updateComparison();
        return;
    }

    // Si ya hay dos seleccionadas o son de otra divisi√≥n ‚Üí reiniciar selecci√≥n
    if (
        selectedRows.length === 2 ||
        (selectedRows.length === 1 && selectedRows[0].closest('tbody').id !== division)
    ) {
        selectedRows.forEach(r => r.classList.remove('bg-indigo-700', 'shadow-lg'));
        selectedRows = [];
    }

    // Agregar nueva selecci√≥n con efecto visual
    row.classList.add('bg-indigo-700', 'shadow-lg', 'ring-2', 'ring-indigo-400', 'transition', 'duration-300');
    selectedRows.push(row);

    updateComparison();
}

// Asigna los listeners a las filas despu√©s de renderizar
function addRowClickListeners() {
    document.querySelectorAll('#clasificacion tbody tr').forEach(row => {
        row.dataset.score = row.querySelector('td:last-child').textContent.trim();
        row.style.cursor = 'pointer';
        row.classList.add('transition', 'duration-200', 'hover:bg-indigo-600');
        row.addEventListener('click', handleRowClick);
    });
}

    
// --- Efecto visual al seleccionar dos personas (zoom sutil y resto gris) ---

// A√±adimos los estilos necesarios para el efecto
const styleFocus = document.createElement("style");
styleFocus.innerHTML = `
@keyframes focusPop {
  0% { box-shadow: none; background-color: rgba(99,102,241,0.2); }
  100% { box-shadow: 0 0 25px rgba(99,102,241,0.6); background-color: rgba(99,102,241,0.3); }
}
  0% { transform: scale(1); box-shadow: none; }
  100% {  box-shadow: 0 0 20px rgba(99,102,241,0.5); }
}
.focused {
  box-shadow: 0 0 25px rgba(99,102,241,0.6);
  background-color: rgba(99,102,241,0.3);
  position: relative;
  z-index: 10;

  animation: focusPop 0.3s ease-out forwards;
  z-index: 10;
  position: relative;
}
.dimmed {
  opacity: 0.4;
  filter: grayscale(100%);
  transition: opacity 0.3s ease, filter 0.3s ease;
}
`;
document.head.appendChild(styleFocus);

// Sobrescribimos updateComparison para a√±adir el nuevo efecto visual
const oldUpdateComparison = updateComparison;
updateComparison = function() {
    oldUpdateComparison();

    // Limpiar cualquier estado anterior
    document.querySelectorAll('#clasificacion tbody tr').forEach(r => {
        r.classList.remove('focused', 'dimmed');
    });

    if (selectedRows.length === 2) {
        const [row1, row2] = selectedRows;
        const allRows = Array.from(row1.closest('tbody').querySelectorAll('tr'));

        // Aplicar efecto visual
        allRows.forEach(r => {
            if (r !== row1 && r !== row2) {
                r.classList.add('dimmed');
            }
        });
        row1.classList.add('focused');
        row2.classList.add('focused');
    }
};


// --- Funciones Deluxe ---

// Bot√≥n "Volver arriba"
const backToTop = document.createElement('button');
backToTop.id = 'back-to-top';
backToTop.innerHTML = '‚Üë';
document.body.appendChild(backToTop);

window.addEventListener('scroll', () => {
  backToTop.style.display = window.scrollY > 200 ? 'flex' : 'none';
});

backToTop.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Transici√≥n de pesta√±as con fade
tabButtons.forEach(button => {
  button.addEventListener('click', () => {
    tabContents.forEach(content => content.classList.remove('active'));
    const target = document.getElementById(button.dataset.tab);
    setTimeout(() => target.classList.add('active'), 50);
  });
});

// Versus card animado
const versusCard = document.createElement('div');
versusCard.id = 'versus-card';
document.body.appendChild(versusCard);

const oldUpdateComparisonDeluxe = updateComparison;
updateComparison = function() {
  oldUpdateComparisonDeluxe();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;

    versusCard.innerHTML = `
      <img src="${img1}" alt="${name1}">
      <span>${name1}</span>
      <span class="text-red-400 text-2xl mx-2">VS</span>
      <span>${name2}</span>
      <img src="${img2}" alt="${name2}">
    `;
    versusCard.style.display = 'flex';
  }
};




// Forzar pesta√±a "Reglas y Comodines" activa al cargar
document.addEventListener('DOMContentLoaded', () => {
  const defaultTab = document.querySelector('[data-tab="reglas"]');
  const defaultContent = document.getElementById('reglas');
  if (defaultTab && defaultContent) {
    defaultContent.classList.add('active');
    // defaultTab.classList.add('bg-indigo-700');
  }
});


// --- Versus card mejorado con puntuaciones y animaci√≥n de golpe ---
const oldUpdateComparisonPower = updateComparison;
updateComparison = function() {
  oldUpdateComparisonPower();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner, loser;
    if (score1 > score2) { winner = 1; } 
    else if (score2 > score1) { winner = 2; }
    else { winner = 0; }

    versusCard.innerHTML = `
      <div class="player ${winner === 1 ? 'text-green-400' : (winner === 2 ? 'text-red-400' : '')}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span>${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <span class="text-yellow-400 text-2xl mx-4">‚ö° VS ‚ö°</span>
      <div class="player ${winner === 2 ? 'text-green-400' : (winner === 1 ? 'text-red-400' : '')}" id="p2">
        <span class="score">${score2}</span>
        <span>${name2}</span>
        <img src="${img2}" alt="${name2}">
      </div>
    `;
    versusCard.style.display = 'flex';

    const diffMsg = document.createElement('div');
    diffMsg.id = 'versus-diff';
    diffMsg.textContent = `üí• Diferencia de puntos: ${diff}`;
    versusCard.insertAdjacentElement('afterend', diffMsg);

    // Animaciones de "golpe"
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    if (winner === 1) {
      p1.style.animation = 'pushForward 0.5s ease forwards';
      p2.style.animation = 'pushBack 0.5s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForward 0.5s ease forwards';
      p1.style.animation = 'pushBack 0.5s ease forwards';
    }
  }
};


// --- Versus card versi√≥n definitiva con animaciones y estructura visual ---
const oldUpdateComparisonFinal = updateComparison;
updateComparison = function() {
  oldUpdateComparisonFinal();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner = 0;
    if (score1 > score2) winner = 1;
    else if (score2 > score1) winner = 2;

    const p1Color = winner === 1 ? 'text-green-400' : winner === 2 ? 'text-red-400' : 'text-gray-300';
    const p2Color = winner === 2 ? 'text-green-400' : winner === 1 ? 'text-red-400' : 'text-gray-300';

    versusCard.innerHTML = `
      <div class="player ${p1Color}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span class="name">${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <span class="vs-symbol">‚ö° VS ‚ö°</span>
      <div class="player ${p2Color}" id="p2">
        <img src="${img2}" alt="${name2}">
        <span class="name">${name2}</span>
        <span class="score">${score2}</span>
      </div>
    `;
    versusCard.style.display = 'flex';

    const diffMsg = document.createElement('div');
    diffMsg.id = 'versus-diff';
    diffMsg.textContent = `üí• Diferencia de puntos: ${diff}`;
    versusCard.insertAdjacentElement('afterend', diffMsg);

    // Animaciones de impacto
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    const vsSymbol = versusCard.querySelector('.vs-symbol');

    if (winner === 1) {
      p1.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p2.style.animation = 'pushBackShake 0.6s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p1.style.animation = 'pushBackShake 0.6s ease forwards';
    }

    vsSymbol.style.animation = 'vsImpact 0.6s ease';
  }
};


// --- Ajuste: diferencia centrada debajo del VS ---
const oldUpdateComparisonCentered = updateComparison;
updateComparison = function() {
  oldUpdateComparisonCentered();

  versusCard.style.display = 'none';
  versusCard.innerHTML = '';
  const existingDiff = document.getElementById('versus-diff');
  if (existingDiff) existingDiff.remove();

  if (selectedRows.length === 2) {
    const [row1, row2] = selectedRows;
    const name1 = row1.querySelector('span').textContent;
    const name2 = row2.querySelector('span').textContent;
    const img1 = row1.querySelector('img').src;
    const img2 = row2.querySelector('img').src;
    const score1 = parseInt(row1.dataset.score);
    const score2 = parseInt(row2.dataset.score);
    const diff = Math.abs(score1 - score2);

    let winner = 0;
    if (score1 > score2) winner = 1;
    else if (score2 > score1) winner = 2;

    const p1Color = winner === 1 ? 'text-green-400' : winner === 2 ? 'text-red-400' : 'text-gray-300';
    const p2Color = winner === 2 ? 'text-green-400' : winner === 1 ? 'text-red-400' : 'text-gray-300';

    versusCard.innerHTML = `
      <div class="player ${p1Color}" id="p1">
        <img src="${img1}" alt="${name1}">
        <span class="name">${name1}</span>
        <span class="score">${score1}</span>
      </div>
      <div class="vs-container text-center">
        <span class="vs-symbol">‚ö° VS ‚ö°</span>
        <div class="diff-center">üí• Diferencia: ${diff}</div>
      </div>
      <div class="player ${p2Color}" id="p2">
        <img src="${img2}" alt="${name2}">
        <span class="name">${name2}</span>
        <span class="score">${score2}</span>
      </div>
    `;
    versusCard.style.display = 'flex';

    // Animaciones de impacto
    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    const vsSymbol = versusCard.querySelector('.vs-symbol');

    if (winner === 1) {
      p1.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p2.style.animation = 'pushBackShake 0.6s ease forwards';
    } else if (winner === 2) {
      p2.style.animation = 'pushForwardSmooth 0.6s ease forwards';
      p1.style.animation = 'pushBackShake 0.6s ease forwards';
    }

    vsSymbol.style.animation = 'vsImpact 0.6s ease';
  }
};


// --- OVERRIDE: Clean Versus Card Rendering (final) ---
(function() {
  // Add/override styles to ensure consistent appearance
  const styleEl = document.createElement('style');
  styleEl.innerHTML = `
  /* Final versus styles - override previous conflicting rules */
  #versus-card {
  padding: 2rem 3rem 2.5rem 3rem;
  min-width: 600px;
  min-height: 220px;
 position: fixed !important; top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important; display: none; flex-direction: row; align-items: center; justify-content: center; gap: 2rem; padding: 1rem 2rem; border-radius: 1rem; background: rgba(17,24,39,0.95); border: 2px solid rgba(99,102,241,0.12); z-index: 9999; }
  #versus-card .player { display:flex; flex-direction:column; align-items:center; min-width:130px; }
  #versus-card .player img {
  width: 85px;
  height: 85px;
 width:70px; height:70px; border-radius:50%; object-fit:cover; margin-bottom:6px; border:2px solid #818cf8; }
  #versus-card .name { font-size:1rem; margin-bottom:4px; }
  #versus-card .score { font-size:1.25rem; color:#facc15; font-weight:700; margin-top:6px; }
  #versus-card .vs-container { position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center; }
  #versus-card .vs-symbol { font-size:1.8rem; color:#facc15; display:block; }
  #versus-card .diff-center {
  background: transparent !important;
  text-shadow: none !important;
 position:absolute; top:100%; left:50%; transform:translate(-50%,6px); color:#facc15; font-weight:700; padding:6px 10px; background: rgba(0,0,0,0.2); border-radius:8px; backdrop-filter: blur(6px); box-shadow:0 6px 18px rgba(0,0,0,0.5); opacity:0; animation: popUpDiff 0.45s ease forwards; }
  @keyframes popUpDiff { 0% { transform: translate(-50%,12px) scale(0.9); opacity:0 } 60% { transform: translate(-50%, -6px) scale(1.05); opacity:1 } 100% { transform: translate(-50%,6px) scale(1); opacity:1 } }
  @keyframes pushForwardSmooth { 0% { transform: translateX(0) scale(1); } 40% { transform: translateX(18px) scale(1.08); } 100% { transform: translateX(12px) scale(1.03); } }
  @keyframes pushBackSmooth { 0% { transform: translateX(0) scale(1); opacity:1; } 100% { transform: translateX(-8px) scale(0.96); opacity:0.85; } }
  .winner-anim { animation: pushForwardSmooth 0.55s cubic-bezier(.2,.9,.3,1) forwards; }
  .loser-anim { animation: pushBackSmooth 0.55s cubic-bezier(.2,.9,.3,1) forwards; }
  `;
  document.head.appendChild(styleEl);

  // Ensure versusCard exists
  let versusCard = document.getElementById('versus-card');
  if (!versusCard) {
    versusCard = document.createElement('div');
    versusCard.id = 'versus-card';
    document.body.appendChild(versusCard);
  }

  // Replace global updateComparison with a clean version
  window.updateComparison = function() {
    // first, clear any old elements created by previous versions
    const oldDiffs = document.querySelectorAll('#versus-diff, .diff-center, .diff-center-old');
    oldDiffs.forEach(e => e.remove());

    // reset versus card
    versusCard.style.display = 'none';
    versusCard.innerHTML = '';

    // clear previous animations on players
    document.querySelectorAll('#versus-card .player').forEach(p => { p.classList.remove('winner-anim','loser-anim'); });

    if (Array.isArray(selectedRows) && selectedRows.length === 2) {
      const [row1,row2] = selectedRows;
      const name1 = row1.querySelector('td:nth-child(2) span') ? row1.querySelector('td:nth-child(2) span').textContent : (row1.querySelector('span')?row1.querySelector('span').textContent : row1.textContent.trim());
      const name2 = row2.querySelector('td:nth-child(2) span') ? row2.querySelector('td:nth-child(2) span').textContent : (row2.querySelector('span')?row2.querySelector('span').textContent : row2.textContent.trim());
      const img1 = row1.querySelector('img') ? row1.querySelector('img').src : 'https://placehold.co/64x64/374151/ffffff?text=U';
      const img2 = row2.querySelector('img') ? row2.querySelector('img').src : 'https://placehold.co/64x64/374151/ffffff?text=U';
      const score1 = parseInt(row1.dataset.score) || 0;
      const score2 = parseInt(row2.dataset.score) || 0;
      const diff = Math.abs(score1-score2);

      let winner = 0;
      if (score1 > score2) winner = 1;
      else if (score2 > score1) winner = 2;

      // Build HTML
      versusCard.innerHTML = `
        <div class="player" id="p1">
          <img src="${img1}" alt="${name1}"/>
          <span class="name" id="name1">${name1}</span>
          <span class="score" id="score1">${score1}</span>
        </div>
        <div class="vs-container">
          <span class="vs-symbol">‚ö° VS ‚ö°</span>
          <div class="diff-center" id="diff-center">üí• Diferencia: ${diff}</div>
        </div>
        <div class="player" id="p2">
          <img src="${img2}" alt="${name2}"/>
          <span class="name" id="name2">${name2}</span>
          <span class="score" id="score2">${score2}</span>
        </div>
      `;

      // color winners/losers
      const p1 = document.getElementById('p1');
      const p2 = document.getElementById('p2');
      const nameEl1 = document.getElementById('name1');
      const nameEl2 = document.getElementById('name2');
      const scoreEl1 = document.getElementById('score1');
      const scoreEl2 = document.getElementById('score2');

      if (winner === 1) {
        nameEl1.classList.add('text-green-400'); scoreEl1.classList.add('text-green-400'); p1.classList.add('winner-anim');
        nameEl2.classList.add('text-red-400'); scoreEl2.classList.add('text-red-400'); p2.classList.add('loser-anim');
      } else if (winner === 2) {
        nameEl2.classList.add('text-green-400'); scoreEl2.classList.add('text-green-400'); p2.classList.add('winner-anim');
        nameEl1.classList.add('text-red-400'); scoreEl1.classList.add('text-red-400'); p1.classList.add('loser-anim');
      } else {
        // tie: neutral colors
        nameEl1.classList.add('text-gray-200'); nameEl2.classList.add('text-gray-200');
      }

      versusCard.style.display = 'flex';

      // remove animations after they finish so subsequent opens run again
      setTimeout(()=>{
        p1.classList.remove('winner-anim','loser-anim');
        p2.classList.remove('winner-anim','loser-anim');
      }, 900);
    } else {
      // no two selected -> hide versus card
      versusCard.style.display = 'none';
    }
  };
})(); 


// --- Ocultar versus-card al hacer scroll instant√°neamente ---
window.addEventListener('scroll', () => {
  if (typeof versusCard !== 'undefined' && versusCard && versusCard.style.display === 'flex') {
    versusCard.style.display = 'none';
    const diffEl = document.querySelector('.diff-center');
    if (diffEl) diffEl.remove();
  }
});

</script>
</body>
</html>






