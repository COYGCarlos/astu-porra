<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstuPorra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #111827;
            color: #e5e7eb;
        }
        h1, h2, h3 {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
        }
        .card {
            background-color: #1f2937;
            border-radius: 0.75rem;
            border: 1px solid #374151;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s;
            cursor: pointer; /* Indica que es clickeable */
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
        }
        .favor-card { border-left: 4px solid #10b981; }
        .contra-card { border-left: 4px solid #ef4444; }
        .favor-header { background-color: rgba(16, 185, 129, 0.1); color: #10b981; }
        .contra-header { background-color: rgba(239, 68, 68, 0.1); color: #ef4444; }

        /* Estilo para comod√≠n seleccionado */
        .card.selected {
            border-color: #3b82f6; /* Borde azul para destacar */
            box-shadow: 0 0 0 3px #3b82f6;
            transform: scale(1.02);
        }
        .card.selected .favor-card, .card.selected .contra-card {
             border-left-width: 8px; /* Borde izquierdo m√°s grueso */
        }

        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .tag-uso { background-color: #374151; color: #d1d5db; }
        .tag-orientacion { background-color: #4b5563; color: #d1d5db; }
        .filter-btn {
            transition: all 0.2s;
            border: 1px solid #4b5563;
        }
        .filter-btn.active {
            color: #111827;
        }
        .filter-btn-favor.active { background-color: #10b981; border-color: #10b981;}
        .filter-btn-contra.active { background-color: #ef4444; border-color: #ef4444; }
        #searchInput {
            background-color: #374151;
            border: 1px solid #4b5563;
        }
        .tab-btn {
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
            color: #9ca3af;
        }
        .tab-btn.active {
            background-color: #1f2937;
            border-bottom-color: #3b82f6;
            color: #ffffff;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background-color: #374151;
            border-bottom: 1px solid #4b5563;
            font-weight: 700;
        }
        tr:nth-child(even) {
            background-color: #1f2937;
        }
        .profile-img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin-right: 8px;
            display: inline-block;
            vertical-align: middle;
            border: 2px solid #3b82f6;
        }
        /* Estilo para el bot√≥n de acci√≥n */
        #confirmSelectionBtn {
            background-color: #3b82f6;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 700;
            transition: background-color 0.2s;
        }
        #confirmSelectionBtn:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-6xl font-bold tracking-wider text-white">AstuPorra</h1>
            <p class="text-xl md:text-2xl text-gray-400 mt-2">Reglamento, Comodines y Clasificaci√≥n</p>
        </header>

        <nav class="flex justify-center mb-8 border-b-2 border-gray-700">
            <button id="rulesTabBtn" class="tab-btn px-6 py-3 font-semibold active">Reglas y Comodines</button>
            <button id="standingsTabBtn" class="tab-btn px-6 py-3 font-semibold">Clasificaci√≥n</button>
        </nav>

        <main>
            <div id="rulesContent">
                <section id="reglas" class="mb-16">
                    <h2 class="text-3xl font-bold mb-8 text-center border-b-2 border-gray-700 pb-4">Reglas Fundamentales</h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="card p-6">
                            <div class="flex items-center mb-4">
                                <span class="text-3xl mr-4">üõ°Ô∏è</span>
                                <h3 class="text-2xl font-bold">Uso Divisional</h3>
                            </div>
                            <p class="text-gray-300">La regla m√°s importante: los comodines <span class="font-bold text-yellow-400">S√ìLO</span> se pueden usar entre participantes de la misma divisi√≥n. ¬°La batalla es interna!</p>
                        </div>
                        <div class="card p-6">
                            <div class="flex items-center mb-4">
                                <span class="text-3xl mr-4">üóìÔ∏è</span>
                                <h3 class="text-2xl font-bold">Frecuencia y Eventos</h3>
                            </div>
                            <p class="text-gray-300">Se permite usar <span class="font-bold text-yellow-400">un comod√≠n por PPV/PLE</span>. En eventos de dos noches como WrestleMania, solo se podr√° usar un comod√≠n en total.</p>
                        </div>
                        <div class="card p-6">
                            <div class="flex items-center mb-4">
                                <span class="text-3xl mr-4">üéØ</span>
                                <h3 class="text-2xl font-bold">L√≠mite de Ataques</h3>
                            </div>
                            <p class="text-gray-300">Un oponente solo puede ser atacado <span class="font-bold text-yellow-400">dos veces por evento</span>. Un tercer intento de ataque ser√° denegado para evitar el acoso.</p>
                        </div>
                    </div>
                </section>
                
                <section id="eleccion" class="mb-16">
                    <h2 class="text-3xl font-bold mb-8 text-center border-b-2 border-gray-700 pb-4">Proceso de Elecci√≥n de Comodines</h2>
                    <div class="card p-8">
                        <p class="text-center text-gray-300 mb-8">Para asegurar un proceso justo y organizado, la elecci√≥n de comodines se har√° por turnos basados en la clasificaci√≥n del evento anterior. Sigue estos pasos:</p>
                        <ol class="relative border-l border-gray-600 space-y-10 pl-6">
                            <li class="flex items-start">
                                <div class="absolute -left-4 top-1 flex items-center justify-center bg-blue-500 h-8 w-8 rounded-full ring-4 ring-gray-800 text-white font-bold">1</div>
                                <div class="ml-4">
                                    <h4 class="text-xl font-bold text-white">Anuncio del Orden</h4>
                                    <p class="text-gray-400 mt-1">Tras cada PPV, AEKCarlos publicar√° el orden de elecci√≥n en el canal <code class="bg-gray-700 text-yellow-300 px-2 py-1 rounded">#elecci√≥n-comod√≠n</code>.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div class="absolute -left-4 top-1 flex items-center justify-center bg-blue-500 h-8 w-8 rounded-full ring-4 ring-gray-800 text-white font-bold">2</div>
                                <div class="ml-4">
                                    <h4 class="text-xl font-bold text-white">L√≠mite de Tiempo (12h)</h4>
                                    <p class="text-gray-400 mt-1">Cada jugador tiene 12 horas para elegir. Si el tiempo expira, el turno pasa al siguiente. El jugador que perdi√≥ su turno podr√° elegir m√°s tarde de entre los comodines restantes.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div class="absolute -left-4 top-1 flex items-center justify-center bg-blue-500 h-8 w-8 rounded-full ring-4 ring-gray-800 text-white font-bold">3</div>
                                <div class="ml-4">
                                    <h4 class="text-xl font-bold text-white">C√≥mo Pedir el Comod√≠n</h4>
                                    <p class="text-gray-400 mt-1">Cuando sea tu turno, escribe en el canal: <code class="bg-gray-700 text-yellow-300 px-2 py-1 rounded">Elijo comod√≠n [NOMBRE] @AEKCarlos</code>. La menci√≥n es obligatoria.</p>
                                </div>
                            </li>
                        </ol>
                    </div>
                </section>
                <section id="explorador">
                    <h2 class="text-3xl font-bold mb-4 text-center border-b-2 border-gray-700 pb-4">Explorador de Comodines</h2>
                    <p class="text-center text-gray-400 mb-8">Usa los filtros para encontrar r√°pidamente el comod√≠n que necesitas. **Haz clic en cualquier comod√≠n para seleccionarlo/deseleccionarlo.**</p>
                    
                    <div class="card p-6 mb-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Buscar por nombre:</label>
                                <input type="text" id="searchInput" placeholder="Ej: Phoenix Splash" class="w-full rounded-md p-2 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Filtrar por tipo:</label>
                                <div class="flex space-x-2">
                                    <button data-filter-type="all" class="filter-btn flex-1 p-2 rounded-md font-semibold active">Todos</button>
                                    <button data-filter-type="favor" class="filter-btn flex-1 p-2 rounded-md font-semibold">A Favor</button>
                                    <button data-filter-type="contra" class="filter-btn flex-1 p-2 rounded-md font-semibold">En Contra</button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Filtrar por uso:</label>
                                <select id="usoFilter" class="w-full rounded-md p-2 bg-gray-800 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                    <option value="all">Todos</option>
                                    <option value="Antes">Antes</option>
                                    <option value="Despu√©s">Despu√©s</option>
                                    <option value="Durante">Durante</option>
                                    <option value="Antes / Durante">Antes / Durante</option>
                                    <option value="Durante / Despu√©s">Durante / Despu√©s</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Filtrar por orientaci√≥n:</label>
                                <select id="orientacionFilter" class="w-full rounded-md p-2 bg-gray-800 text-white focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                    <option value="all">Todos</option>
                                    <option value="Media / Baja">Media / Baja</option>
                                    <option value="Divisional">Divisional</option>
                                    <option value="General">General</option>
                                    <option value="2¬™ Divisi√≥n">2¬™ Divisi√≥n</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div id="wildcard-container" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Los comodines se renderizan aqu√≠ -->
                    </div>

                    <!-- Nueva secci√≥n para el bot√≥n de acci√≥n y el resumen -->
                    <div class="mt-12 text-center">
                        <button id="confirmSelectionBtn" disabled class="opacity-50 cursor-not-allowed">
                            Mostrar Selecci√≥n (0 Comodines)
                        </button>
                    </div>

                    <div id="seleccion-resumen" class="mt-12 hidden">
                        <h2 class="text-3xl font-bold mb-4 text-center border-b-2 border-blue-700 pb-4 text-blue-400">Comodines Seleccionados</h2>
                        <div id="summary-container" class="grid sm:grid-cols-1 lg:grid-cols-2 gap-6">
                            <p class="col-span-1 lg:col-span-2 text-center text-gray-400">Ning√∫n comod√≠n seleccionado.</p>
                        </div>
                        <div class="mt-8 p-4 bg-yellow-900/30 border border-yellow-700 rounded-lg text-yellow-300 text-center">
                            <p class="font-semibold">Nota: Esta es solo una previsualizaci√≥n. Recuerda usar el formato correcto en el canal de Discord para confirmar tu elecci√≥n.</p>
                        </div>
                    </div>
                </section>
            </div>

            <div id="standingsContent" class="hidden">
                <section id="clasificacion" class="mb-16">
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-center">1¬™ Divisi√≥n</h3>
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="rounded-tl-lg">Posici√≥n</th>
                                    <th>Usuario</th>
                                    <th class="rounded-tr-lg">Puntuaci√≥n Total</th>
                                </tr>
                            </thead>
                            <tbody id="division1-table">
                                </tbody>
                        </table>
                    </div>
                    <div class="card p-6 mt-8">
                        <h3 class="text-2xl font-bold mb-4 text-center">2¬™ Divisi√≥n</h3>
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="rounded-tl-lg">Posici√≥n</th>
                                    <th>Usuario</th>
                                    <th class="rounded-tr-lg">Puntuaci√≥n Total</th>
                                </tr>
                            </thead>
                            <tbody id="division2-table">
                                </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>

        <footer class="text-center mt-16 pt-8 border-t border-gray-800">
            <p class="text-gray-500">Reglamento y aplicaci√≥n dise√±ados por AEKCarlos.</p>
        </footer>
    </div>

    <script>
        const wildcards = [
            { name: "Phoenix Splash", type: "favor", explanation: "Si aciertas el ganador del combate inicial del PPV, obtienes un bono de +4 puntos en ese combate.", use: "Despu√©s", orientation: "Media / Baja" },
            { name: "GTS (Go to Sleep)", type: "favor", explanation: "Puedes \"dormir\" un comod√≠n En Contra que otro usuario de tu misma divisi√≥n haya usado contra ti en este PPV, dej√°ndolo inactivo.", use: "Antes / Durante", orientation: "Divisional" },
            { name: "Guerrilla Tactics", type: "favor", explanation: "Si fallas una predicci√≥n, puedes usar este comod√≠n para que los puntos de esa predicci√≥n no resten, aunque normalmente lo har√≠an.", use: "Despu√©s", orientation: "General" },
            { name: "Five Knuckle Shuffle", type: "favor", explanation: "Te permite duplicar los puntos obtenidos en una predicci√≥n si es un combate sin t√≠tulo en juego.", use: "Antes", orientation: "General" },
            { name: "Sweet Chin Music", type: "favor", explanation: "Si predices que el combate terminar√° por super-kick o finisher de impacto visual, y aciertas, obtienes +3 puntos extra.", use: "Antes", orientation: "General" },
            { name: "Foreign Exchange", type: "favor", explanation: "Puedes intercambiar tu predicci√≥n menos popular por la m√°s popular de un rival en tu misma divisi√≥n.", use: "Antes", orientation: "Divisional" },
            { name: "Macho Madness", type: "favor", explanation: "Si aciertas el resultado de todos los combates con vestimenta extravagante o gimmick particular, obtienes +7 puntos.", use: "Despu√©s", orientation: "General" },
            { name: "Diamond Cutter", type: "favor", explanation: "Si tu predicci√≥n de un combate termina en menos de 3 minutos, y la aciertas, obtienes x3 los puntos.", use: "Despu√©s", orientation: "General" },
            { name: "Head of the Table", type: "favor", explanation: "Si aciertas la predicci√≥n de todos los campeonatos masculinos principales, obtienes un bono de +6 puntos.", use: "Despu√©s", orientation: "General" },
            { name: "EST of WWE", type: "favor", explanation: "Si aciertas la predicci√≥n de todos los campeonatos femeninos principales, obtienes un bono de +6 puntos.", use: "Despu√©s", orientation: "General" },
            { name: "Countdown Clock", type: "favor", explanation: "Te permite enviar una predicci√≥n para un combate espec√≠fico hasta 1 minuto antes de que comience ese combate.", use: "Durante", orientation: "General" },
            { name: "Legend Killer", type: "favor", explanation: "Si predices y aciertas la victoria de una estrella joven sobre un veterano, obtienes +5 puntos extra.", use: "Antes", orientation: "General" },
            { name: "Punt Kick", type: "favor", explanation: "Elige a un luchador \"favorito\" (el que m√°s gente predijo); si pierde, obtienes +8 puntos.", use: "Antes", orientation: "General" },
            { name: "Rated R Superstar", type: "favor", explanation: "Si aciertas la predicci√≥n de un combate que termine por sumisi√≥n o rendici√≥n, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { name: "The List of Jericho", type: "favor", explanation: "Elige a un rival de tu misma divisi√≥n; si aciertas el mismo n√∫mero de predicciones que √©l, obtienes +3 puntos adicionales sobre su total.", use: "Despu√©s", orientation: "Divisional" },
            { name: "People Power", type: "favor", explanation: "Si aciertas la victoria del luchador que es √∫ltima opci√≥n en la predicci√≥n de la mayor√≠a, obtienes +5 puntos extra.", use: "Antes", orientation: "Media / Baja" },
            { name: "The Viper's RKO", type: "favor", explanation: "Puedes cambiar la predicci√≥n de un combate ya cerrado por la que menos gente ha elegido como ganadora.", use: "Antes", orientation: "General" },
            { name: "Cesaro Swing", type: "favor", explanation: "Si aciertas una predicci√≥n triple o fatal de cuatro esquinas, los puntos se multiplican por x2.", use: "Antes", orientation: "General" },
            { name: "Coup de Gr√¢ce", type: "favor", explanation: "Si aciertas la predicci√≥n del Main Event con una explicaci√≥n detallada sobre el booking, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { name: "Sister Abigail", type: "favor", explanation: "Te permite hacer una doble predicci√≥n en un combate: si aciertas ambas (ganador y m√©todo), triplicas los puntos.", use: "Antes", orientation: "General" },
            { name: "Cross Rhodes", type: "favor", explanation: "Anula una penalizaci√≥n de puntos que te haya impuesto un comod√≠n En Contra de tu misma divisi√≥n.", use: "Durante / Despu√©s", orientation: "Divisional" },
            { name: "Coast to Coast", type: "favor", explanation: "Si aciertas una predicci√≥n de combate de escaleras, mesas o sillas, obtienes +4 puntos extra.", use: "Antes", orientation: "General" },
            { name: "Hulk Up", type: "favor", explanation: "Si fallas tu predicci√≥n del Main Event, pero tu luchador \"favorito\" gana, se te suma +5 puntos para mitigar la p√©rdida.", use: "Antes", orientation: "General" },
            { name: "Division Ace", type: "favor", explanation: "Elige a un luchador; si t√∫ eres el √∫nico de tu divisi√≥n que predice su victoria, y aciertas, obtienes +4 puntos extra.", use: "Antes", orientation: "Divisional" },
            { name: "Promotion Play", type: "favor", explanation: "Si eres de la 2¬™ Divisi√≥n y aciertas todos tus combates, obtienes un bono de +10 puntos para el total de la porra.", use: "Despu√©s", orientation: "2¬™ Divisi√≥n" },
            { name: "Relegation Threat", type: "contra", explanation: "Obligas a que la predicci√≥n del Main Event de un rival de tu misma divisi√≥n valga solo 1 punto si acierta.", use: "Antes", orientation: "Divisional" },
            { name: "Bottom Feeder Lock", type: "contra", explanation: "La predicci√≥n con m√°s puntos de un rival de tu misma divisi√≥n vale 0 si la acierta.", use: "Antes", orientation: "Divisional" },
            { name: "Mid-Card Blockade", type: "contra", explanation: "Elige a un rival de la mitad superior de tu misma divisi√≥n; su predicci√≥n m√°s popular se le resta -4 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { name: "The Manager's Cut", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta, y ese combate tuvo interferencia de un Manager, pierde -3 puntos.", use: "Antes", orientation: "Divisional" },
            { name: "Draw Out", type: "contra", explanation: "Si hay un empate en el n√∫mero de aciertos entre t√∫ y un rival de tu misma divisi√≥n, puedes restarle -5 puntos del total de la porra.", use: "Despu√©s", orientation: "Divisional" },
            { name: "Contender‚Äôs Trap", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta la predicci√≥n de un combate por t√≠tulo secundario, no suma ning√∫n punto.", use: "Antes", orientation: "Divisional" },
            { name: "Suspension", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; no puede usar ning√∫n comod√≠n en el pr√≥ximo PPV.", use: "Antes", orientation: "Divisional" },
            { name: "Backstage Politics", type: "contra", explanation: "Obliga al rival de tu misma divisi√≥n a que su predicci√≥n del combate m√°s largo del PPV valga 0 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { name: "The Curse of the Zone", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n que vaya en la zona baja; su predicci√≥n del Main Event se anula si la acierta.", use: "Antes", orientation: "Divisional" },
            { name: "Division Jump", type: "contra", explanation: "Puedes cambiar la predicci√≥n del Main Event de un rival de tu misma divisi√≥n a un resultado de Descalificaci√≥n.", use: "Antes", orientation: "Divisional" },
            { name: "Disqualification Push", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; su predicci√≥n de combate debe ser Descalificaci√≥n; si acierta, solo suma 1 punto.", use: "Antes", orientation: "Divisional" },
            { name: "Rating Drop", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta un combate que la mayor√≠a predijo que ganar√≠a el Face, solo suma la mitad de los puntos.", use: "Antes", orientation: "Divisional" },
            { name: "The Gold Diggers", type: "contra", explanation: "Si un rival de tu misma divisi√≥n usa un comod√≠n \"A Favor\" para obtener puntos extra, puedes robar 50% de esos puntos extra.", use: "Despu√©s", orientation: "Divisional" },
            { name: "Injury Angle", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si acierta menos de la mitad de sus predicciones, le restas -6 puntos del total de la porra.", use: "Despu√©s", orientation: "Divisional" },
            { name: "Losers Bracket", type: "contra", explanation: "Si el rival va en la mitad inferior de su divisi√≥n, su predicci√≥n m√°s popular resta -2 puntos si acierta.", use: "Antes", orientation: "Media / Baja" },
            { name: "False Finish", type: "contra", explanation: "Elige la predicci√≥n de un rival de tu misma divisi√≥n; si su luchador gana, pero el combate tiene un final r√°pido/pol√©mico, pierde -3 puntos.", use: "Antes", orientation: "Divisional" },
            { name: "Booking Block", type: "contra", explanation: "Anula cualquier comod√≠n A Favor de un rival de tu misma divisi√≥n cuyo prop√≥sito sea a√±adir puntos extra.", use: "Antes", orientation: "Divisional" },
            { name: "The Veteran's Gate", type: "contra", explanation: "Obliga a un rival de tu misma divisi√≥n a que su predicci√≥n m√°s importante sea sobre un luchador veterano que t√∫ elijas.", use: "Antes", orientation: "Divisional" },
            { name: "Heel Turn", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si su predicci√≥n m√°s importante es de un luchador Face, y gana, solo suma 2 puntos.", use: "Antes", orientation: "Divisional" },
            { name: "Bad Booking", type: "contra", explanation: "Puedes cambiar el resultado de la predicci√≥n de un rival de tu misma divisi√≥n al menos popular entre todos los usuarios.", use: "Antes", orientation: "Divisional" },
            { name: "Career Threat Match", type: "contra", explanation: "Si el rival de tu misma divisi√≥n acierta su predicci√≥n, y es un combate por un contrato/carrera, no suma ning√∫n punto.", use: "Antes", orientation: "Divisional" },
            { name: "The Forbidden Door", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; su pr√≥ximo comod√≠n A Favor usado solo puede anular un comod√≠n En Contra de la misma divisi√≥n.", use: "Antes / Durante", orientation: "Divisional" },
            { name: "Championship Curse", type: "contra", explanation: "Elige la predicci√≥n de un rival de tu misma divisi√≥n; si es por un t√≠tulo mundial y el campe√≥n retiene, la predicci√≥n resta -5 puntos si acierta.", use: "Antes", orientation: "Divisional" },
            { name: "Unstoppable Dominator", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n que tenga un 80% o m√°s de aciertos; su siguiente predicci√≥n solo le dar√° 1 punto si acierta.", use: "Durante", orientation: "Divisional" },
            { name: "The Corporate Mandate", type: "contra", explanation: "Elige a un rival de tu misma divisi√≥n; si tiene dos predicciones con el mismo resultado, ambas restan -3 puntos si acierta una.", use: "Antes", orientation: "Divisional" }
        ];

        const standings = {
            division1: [
                { position: '1¬∫', user: 'Fabio', score: 388 },
                { position: '2¬∫', user: 'BlissedAstu', score: 378 },
                { position: '3¬∫', user: 'MrKev719', score: 379 },
                { position: '4¬∫', user: 'Geroo', score: 370 },
                { position: '5¬∫', user: 'Gonsa', score: 349 },
                { position: '6¬∫', user: 'AEKCarlos', score: 346 },
                { position: '7¬∫', user: 'bautiiiii', score: 332 }
            ],
            division2: [
                { position: '1¬∫', user: 'Nelsonageitos', score: 352 },
                { position: '2¬∫', user: 'DannyLopez_90', score: 351 },
                { position: '3¬∫', user: 'jairlopezojeda', score: 338 },
                { position: '4¬∫', user: 'Ruiz24_', score: 297 },
                { position: '5¬∫', user: 'Slyever', score: 270 },
                { position: '6¬∫', user: 'patodiego', score: 192 },
                { position: '7¬∫', user: 'dany_1208', score: 98 },
                { position: '8¬∫', user: 'AceSoul', score: 64 }
            ]
        };

        const userAvatars = {
            'Fabio': 'img/Fabio.png',
            'MrKev719': 'img/MrKev719_2.png',
            'BlissedAstu': 'img/BlissedAstu.png',
            'Geroo': 'img/Geroo.png',
            'Gonsa': 'img/Gonsa.png',
            'AEKCarlos': 'img/AEKCarlos.png',
            'bautiiiii': 'img/bautiiiii.png',
            'Nelsonageitos': 'img/Nelsonageitos.png',
            'DannyLopez_90': 'img/DannyLopez_90.png',
            'jairlopezojeda': 'img/jairlopezojeda.png',
            'Ruiz24_': 'img/Ruiz24.png',
            'Slyever': 'img/Slyever.png',
            'patodiego': 'img/patodiego.png',
            'dany_1208': 'img/dany_1208.png',
            'AceSoul': 'img/AceSoul.png'
        };

        const wildcardContainer = document.getElementById('wildcard-container');
        const searchInput = document.getElementById('searchInput');
        const typeButtons = document.querySelectorAll('[data-filter-type]');
        const usoFilter = document.getElementById('usoFilter');
        const orientacionFilter = document.getElementById('orientacionFilter');
        const rulesTabBtn = document.getElementById('rulesTabBtn');
        const standingsTabBtn = document.getElementById('standingsTabBtn');
        const rulesContent = document.getElementById('rulesContent');
        const standingsContent = document.getElementById('standingsContent');
        const division1Table = document.getElementById('division1-table');
        const division2Table = document.getElementById('division2-table');
        // Nuevos elementos para la funcionalidad de selecci√≥n
        const confirmSelectionBtn = document.getElementById('confirmSelectionBtn');
        const seleccionResumen = document.getElementById('seleccion-resumen');
        const summaryContainer = document.getElementById('summary-container');

        let filters = {
            search: '',
            type: 'all',
            uso: 'all',
            orientacion: 'all'
        };

        // Array para almacenar los nombres de los comodines seleccionados
        let selectedWildcards = [];

        // Funci√≥n para manejar la selecci√≥n/deselecci√≥n del comod√≠n
        function toggleWildcardSelection(name) {
            const index = selectedWildcards.indexOf(name);
            if (index > -1) {
                // Deseleccionar
                selectedWildcards.splice(index, 1);
            } else {
                // Seleccionar
                selectedWildcards.push(name);
            }
            // Volver a renderizar los comodines para actualizar el estilo visual
            renderWildcards(false); 
            // Actualizar el bot√≥n de resumen
            updateSummaryButton();
            // Ocultar el resumen si no hay nada seleccionado
            if (selectedWildcards.length === 0) {
                 seleccionResumen.classList.add('hidden');
            }
        }

        // Funci√≥n para actualizar el texto y estado del bot√≥n de resumen
        function updateSummaryButton() {
            const count = selectedWildcards.length;
            confirmSelectionBtn.textContent = `Mostrar Selecci√≥n (${count} Comodines)`;
            if (count > 0) {
                confirmSelectionBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                confirmSelectionBtn.disabled = false;
            } else {
                confirmSelectionBtn.classList.add('opacity-50', 'cursor-not-allowed');
                confirmSelectionBtn.disabled = true;
                seleccionResumen.classList.add('hidden');
            }
        }

        // Funci√≥n para renderizar el resumen de comodines
        function renderSummary() {
            if (selectedWildcards.length === 0) {
                summaryContainer.innerHTML = `<p class="col-span-1 lg:col-span-2 text-center text-gray-400">Ning√∫n comod√≠n seleccionado.</p>`;
                return;
            }

            summaryContainer.innerHTML = '';
            
            // Filtramos los objetos completos de los comodines seleccionados
            const summaryWildcards = wildcards.filter(wc => selectedWildcards.includes(wc.name));

            summaryWildcards.forEach(wc => {
                const cardClass = wc.type === 'favor' ? 'favor-card' : 'contra-card';
                const headerClass = wc.type === 'favor' ? 'favor-header' : 'contra-header';
                const typeText = wc.type === 'favor' ? 'A FAVOR' : 'EN CONTRA';

                const cardElement = document.createElement('div');
                cardElement.className = `card ${cardClass} flex flex-col selected`; // Se mantiene el estilo de selecci√≥n
                cardElement.innerHTML = `
                    <div class="p-4 ${headerClass} rounded-t-lg">
                        <h4 class="text-xl font-bold tracking-wide">${wc.name}</h4>
                        <p class="text-sm font-semibold">${typeText}</p>
                    </div>
                    <div class="p-6 flex-grow">
                        <p class="text-gray-300">${wc.explanation}</p>
                    </div>
                    <div class="p-4 bg-gray-800 rounded-b-lg mt-auto flex justify-between items-center text-sm">
                        <span class="tag tag-uso">${wc.use}</span>
                        <span class="tag tag-orientacion">${wc.orientation}</span>
                    </div>
                `;
                summaryContainer.appendChild(cardElement);
            });
        }

        // renderWildcards ahora toma un par√°metro opcional para forzar la limpieza si se necesita
        function renderWildcards(clearSelection = true) {
            wildcardContainer.innerHTML = '';
            if (clearSelection) {
                 // Si se cambia el filtro, se limpia la selecci√≥n (comportamiento habitual en filtros)
                selectedWildcards = [];
                updateSummaryButton();
            }
            
            const filteredWildcards = wildcards.filter(wc => {
                const searchMatch = wc.name.toLowerCase().includes(filters.search.toLowerCase());
                const typeMatch = filters.type === 'all' || wc.type === filters.type;
                const usoMatch = filters.uso === 'all' || wc.use === filters.uso;
                const orientacionMatch = filters.orientacion === 'all' || wc.orientation === filters.orientacion;
                return searchMatch && typeMatch && usoMatch && orientacionMatch;
            });

            if (filteredWildcards.length === 0) {
                wildcardContainer.innerHTML = `<div class="col-span-1 md:col-span-2 xl:col-span-3 text-center text-gray-400 py-10">
                    <p class="text-xl">No se encontraron comodines con los filtros seleccionados.</p>
                </div>`;
                return;
            }

            filteredWildcards.forEach(wc => {
                const cardClass = wc.type === 'favor' ? 'favor-card' : 'contra-card';
                const headerClass = wc.type === 'favor' ? 'favor-header' : 'contra-header';
                const typeText = wc.type === 'favor' ? 'A FAVOR' : 'EN CONTRA';
                const isSelected = selectedWildcards.includes(wc.name) ? ' selected' : '';

                const cardElement = document.createElement('div');
                cardElement.className = `card ${cardClass}${isSelected} flex flex-col`;
                cardElement.dataset.wildcardName = wc.name; // Almacenamos el nombre para el click

                cardElement.innerHTML = `
                    <div class="p-4 ${headerClass} rounded-t-lg">
                        <h4 class="text-xl font-bold tracking-wide">${wc.name}</h4>
                        <p class="text-sm font-semibold">${typeText}</p>
                    </div>
                    <div class="p-6 flex-grow">
                        <p class="text-gray-300">${wc.explanation}</p>
                    </div>
                    <div class="p-4 bg-gray-800 rounded-b-lg mt-auto flex justify-between items-center text-sm">
                        <span class="tag tag-uso">${wc.use}</span>
                        <span class="tag tag-orientacion">${wc.orientation}</span>
                    </div>
                `;
                
                // A√±adir el listener de click para la selecci√≥n
                cardElement.addEventListener('click', () => {
                    toggleWildcardSelection(wc.name);
                });

                wildcardContainer.appendChild(cardElement);
            });
        }

        function renderStandings(data, tableBodyId) {
            const tableBody = document.getElementById(tableBodyId);
            tableBody.innerHTML = '';
            data.forEach(player => {
                const row = document.createElement('tr');
                const avatarUrl = userAvatars[player.user] || 'https://i.pravatar.cc/150';
                row.innerHTML = `
                    <td>${player.position}</td>
                    <td><img src="${avatarUrl}" alt="${player.user}" class="profile-img">${player.user}</td>
                    <td>${player.score}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Listener para el bot√≥n de confirmar/mostrar selecci√≥n
        confirmSelectionBtn.addEventListener('click', () => {
            if (seleccionResumen.classList.contains('hidden')) {
                // Si est√° oculto, lo mostramos y renderizamos el resumen
                seleccionResumen.classList.remove('hidden');
                renderSummary();
                confirmSelectionBtn.textContent = `Ocultar Selecci√≥n (${selectedWildcards.length} Comodines)`;
            } else {
                // Si est√° visible, lo ocultamos
                seleccionResumen.classList.add('hidden');
                confirmSelectionBtn.textContent = `Mostrar Selecci√≥n (${selectedWildcards.length} Comodines)`;
            }
        });

        rulesTabBtn.addEventListener('click', () => {
            rulesContent.classList.remove('hidden');
            standingsContent.classList.add('hidden');
            rulesTabBtn.classList.add('active');
            standingsTabBtn.classList.remove('active');
            renderWildcards(); // Al cambiar de pesta√±a, se mantiene el estado de selecci√≥n
        });

        standingsTabBtn.addEventListener('click', () => {
            rulesContent.classList.add('hidden');
            standingsContent.classList.remove('hidden');
            rulesTabBtn.classList.remove('active');
            standingsTabBtn.classList.add('active');
            renderStandings(standings.division1, 'division1-table');
            renderStandings(standings.division2, 'division2-table');
        });

        // Al cambiar cualquier filtro, reseteamos la selecci√≥n y volvemos a renderizar
        searchInput.addEventListener('input', () => {
            filters.search = searchInput.value;
            renderWildcards();
        });

        typeButtons.forEach(button => {
            button.addEventListener('click', () => {
                typeButtons.forEach(btn => {
                    btn.classList.remove('active', 'filter-btn-favor', 'filter-btn-contra');
                });
                
                const type = button.dataset.filter-type;
                filters.type = type;
                
                button.classList.add('active');
                if (type === 'favor') button.classList.add('filter-btn-favor');
                if (type === 'contra') button.classList.add('filter-btn-contra');

                renderWildcards();
            });
        });
        document.querySelector('[data-filter-type="all"]').classList.add('active');

        usoFilter.addEventListener('change', (e) => {
            filters.uso = e.target.value;
            renderWildcards();
        });

        orientacionFilter.addEventListener('change', (e) => {
            filters.orientacion = e.target.value;
            renderWildcards();
        });
        
        document.addEventListener('DOMContentLoaded', () => {
            renderWildcards();
            updateSummaryButton();
        });
    </script>
</body>
</html>
